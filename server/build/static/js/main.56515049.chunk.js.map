{"version":3,"sources":["constants.js","context.js","utils.js","components/Legend.js","components/Piece.js","components/Tile.js","components/Modal.js","xhr.js","hooks.js","components/GameBoard.js","components/Connection.js","components/ScoreBoard.js","components/Notification.js","components/SwapModal.js","components/ControlButton.js","components/Audio.js","components/Controls.js","components/Bag.js","components/Rack.js","components/GameLogModal.js","components/GameLog.js","components/GamePanel.js","components/GameChooser.js","components/WaitingRoom.js","components/ResumeGame.js","components/JoinGame.js","components/NewGame.js","components/LandingPage.js","components/WinnerModal.js","containers/Game.js","App.js","reportWebVitals.js","index.js"],"names":["URL","window","apiURL","SERVER_TOKEN","b2ctk","API_URL","timeoutDelay","tileColors","normal","tripleWord","startTile","doubleLetter","tripleLetter","doubleWord","String","prototype","capitalize","this","charAt","toUpperCase","slice","toLowerCase","socket","io","transports","GameContext","React","createContext","SocketIOContext","ValidDragContext","NotificationContext","generateRandomID","size","crypto","getRandomValues","Uint32Array","toString","isAlphanumeric","str","match","countUp","number","start","end","duration","excludeMeSioEvent","sio","eventName","myName","dispatch","on","data","name","getDragData","e","JSON","parse","dataTransfer","getData","Legend","className","title","Piece","id","tileID","char","weight","onBoard","isPlayed","isStatic","isTransformed","dragEndHandler","thisPiece","useRef","useContext","validDrag","setValidDrag","useState","pieceData","handleDragEnd","stopImmediatePropagation","current","dropEffect","dragCancelled","handleDragStart","stopPropagation","setData","stringify","setDragData","handleDragDrop","preventDefault","handleDragOver","handleDragEnter","handleDragLeave","useEffect","addEventListener","weightClassNames","classNames","ref","draggable","style","top","Tile","forwardRef","props","useImperativeHandle","addPiece","piece","setPlayedPiece","removePiece","hasPiece","playedPiece","undefined","getPiece","tileType","type","prevTileID","thisTile","player","playedTiles","usedTiles","setPlayedTiles","includes","setRequestChoosePiece","pieceID","status","newPiece","emit","roomID","turn","removeEventListener","fill","strokeWidth","Modal","bag","modal","mode","Object","values","pieces","filter","map","index","onClick","modalHandler","show","axios","defaults","baseURL","headers","post","common","interceptors","request","use","error","console","log","Promise","reject","response","makeServerRequest","opts","requestType","url","payload","then","r","catch","useStateRef","defaultValue","state","setState","useCallback","val","tilePerRow","GameBoard","rows","tileRefs","pingIntervalID","setPingIntervalID","requestChoosePiece","playFlag","setUsedTiles","setBoardState","setPlayFlag","setPlayedWords","recallFlag","setRecallFlag","toRackMove","removePieceFromTile","tID","addPieceToTile","getPlayedWords","Array","length","_","i","tileRows","tileRow","tile","el","push","getTile","refIndex","isBoardEdge","position","wv","wh","words","tileIndex","wordsTop","getPiecesInPosition","wordsLeft","wordsDown","wordsRight","v","a","findIndex","t","ind","loopLength","unshift","iID","setInterval","clearInterval","height","transformedBlankPiece","Connection","icon","iconStatus","ping","setPing","setStatus","showSave","setShowSave","boardState","rackState","pingServer","saveGame","startTime","Date","endTime","pingDuration","getTime","rack","board","setTimeout","color","ScoreBoard","setBoard","players","tableRows","entries","p","tableRow","isSpeaking","score","Notification","notifications","setTimeoutNotifications","timeoutNotifications","notification","iconType","newNotification","message","SwapModal","checkBoxRefs","setShowConfirm","showConfirm","handleOnChange","checkBox","checked","onChange","swapCancelHandler","swapConfirmHandler","checkedBoxes","getCheckedBoxesIDs","descriptions","ControlButton","handler","Audio","useReactMediaRecorder","audio","askPermissionOnMount","mediaBlobUrl","clearBlobUrl","stopRecording","startRecording","setIsMuted","isMuted","setAudioBlob","audioBlob","setSpeakerName","speakerName","setPlayer","setPlayers","updatedPlayers","src","autoPlay","Controls","gameStarted","allowAudio","setControlButtons","controlButtons","buttons","isHost","draw","Bag","setShowContents","showContents","Rack","thisRack","setTryCount","tryCount","setPieces","currPieces","setStartSwap","startSwap","setCountDownID","countDownID","setPlayedPieces","currPlayedPieces","setNotifications","gameResumed","setRackState","timeToPlay","playedWords","gameEnded","setCountDown","countDown","getFromBag","getPieces","actualTurnSkip","playedWordsStr","word","join","validatePlayedWords","bagIsEmpty","rackIsEmpty","playedWord","getPlayedWord","computeScore","refillRack","intervalID","playedPieces","wordWeight","isBingo","totalScore","mul","charWeight","charTileID","charTileType","amount","returnedPieces","addToPieces","findPiece","removePieceFromPieces","addToPlayedPieces","remainingPieces","getTileRow","Math","ceil","checkedIDs","piecesSwapped","pieceToSwap","findPieceByID","isTurnSwapped","validateNeighbors","boardIsEmpty","playDirection","valid","linkCount","tiles","allTiles","source","getTileColumn","first","indexOf","last","getNeigbouringTiles","tileUp","tileDown","tileLeft","tileRight","linkedTiles","forEach","tileTC","initiatePlayPipeline","firstTile","sort","b","firstTileRow","numPlayedTiles","every","tt","getPlayDirection","neighborsAreValid","recall","overwrite","timeout","isBoardEmpty","isTurnSkipped","find","removePieceFromPlayedPieces","seconds","width","shuffle","arr","j","floor","random","temp","inPlaceShuffle","skip","confirm","play","swap","toISOString","substr","GameLogModal","logs","close","time","event","GameLog","setShowModal","showModal","setLogs","leaveHandler","alert","location","reload","GamePanel","GameChooser","setGameChoice","href","target","referrerPolicy","WaitingRoom","setConnectedPlayers","connectedPlayers","setPrepText","prepText","setGameResumed","setGameCreated","setAllowAudio","setTimeToPlay","enableAudio","numPlayers","welcomeMessage","allPlayers","handleDestroyGameSession","ResumeGame","setNumPlayers","sessionID","setSessionID","sessionName","setSessionName","getGameRoomData","gameRoomID","handleResumeGameSession","gameRoomData","currentPlayer","limit","minLength","maxLength","value","trim","placeholder","JoinGame","gameJoined","setGameJoined","handleJoinGameSession","room","joinable","NewGame","gameCreated","setEnableAudio","disabled","parseInt","protocol","hostname","LandingPage","newGame","setNewGame","joinGame","setJoinGame","resumeGame","setResumeGame","choice","WinnerModal","setShow","endMessage","setEndMessage","finalMessage","winner","Game","setGameEnded","setGameStarted","setBag","gameContext","playerToPlay","playerToPlayMessage","playOrderMessage","updatedPlayerTurns","updatedScore","getUpdatedPlayers","announcePlayResult","Set","announceBagState","turnSkips","bagLength","emptyMessage","turnPlayer","gameSpace","Provider","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.56515049.chunk.js","sourcesContent":["\n// In PROD, Jinja would pass the host url to the window object as apiURL\nconst URL = window.apiURL === '{{ ip }}' ? 'http://192.168.0.166:5005' : window.apiURL;\nconst SERVER_TOKEN = window.b2ctk === '{{ b2ctk }}' ? 'ScrabbleDevToken' : window.b2ctk;\n\nconst API_URL = `${URL}/api/v1`;\n\nconst IO_TRANSPORTS = {\n    transports: [\"websocket\", \"polling\"],\n}\n\nconst timeoutDelay = 20000;  // 20s\n\nconst tileColors = {\n    normal: \"bg-white\",\n    tripleWord: \"bg-red-700\",\n    startTile: \"bg-gray-500\",\n    doubleLetter: \"bg-blue-400\",\n    tripleLetter: \"bg-blue-800\",\n    doubleWord: \"bg-yellow-500\",\n}\n\n\n// Allow string capitalization (\"\".capitalize())\nString.prototype.capitalize = function () {\n    return this.charAt(0).toUpperCase() + this.slice(1).toLowerCase();\n}\n\nexport { URL };\nexport { API_URL };\nexport { tileColors };\nexport { timeoutDelay }\nexport { SERVER_TOKEN };\nexport { IO_TRANSPORTS };","import React from 'react';\nimport { io } from 'socket.io-client';\nimport { URL, IO_TRANSPORTS } from './constants';\n\n\nconst socket = io(URL, IO_TRANSPORTS);\n\nconst GameContext = React.createContext();\nconst SocketIOContext = React.createContext();\nconst ValidDragContext = React.createContext();\nconst NotificationContext = React.createContext();\n\nexport { socket };\nexport { GameContext };\nexport { SocketIOContext };\nexport { ValidDragContext };\nexport { NotificationContext };\n","// Helper functions\nimport CountUp from 'react-countup';\n\n\nconst inPlaceShuffle = (arr) => {\n\n    for (let i = arr.length - 1; i > 0; i--) {\n        let j = Math.floor(Math.random() * (i + 1));\n        let temp = arr[i];\n        arr[i] = arr[j];\n        arr[j] = temp;\n    }\n\n    return arr;\n}\n\nconst secondsToMMSS = (seconds) => new Date(seconds * 1000).toISOString().substr(14, 5);\n\nconst generateRandomID = (size) => {\n    return window.crypto\n        .getRandomValues(new Uint32Array(1))[0]\n        .toString()\n        .slice(0, size);\n}\n\nconst isAlphanumeric = (str) => str.match(/^[0-9a-zA-Z]+$/);\n\nconst countUp = (number) => {\n    return <CountUp start={number} end={number} duration={1.5} />\n}\n\nconst countDown = (number) => {\n    return <CountUp start={number + 7} end={number} duration={1.5} />\n}\n\nconst excludeMeSioEvent = (sio, eventName, myName, dispatch) => {\n    sio.on(eventName, (data) => {\n        if (data.name !== myName) dispatch(data);\n    });\n};\n\nconst dragCancelled = (e) => e.dataTransfer.dropEffect === \"none\";\nconst getDragData = (e) => JSON.parse(e.dataTransfer.getData(\"draggedPiece\"));\nconst setDragData = (e, data) => e.dataTransfer.setData(\"draggedPiece\", JSON.stringify(data));\n\nexport { countUp };\nexport { countDown };\nexport { setDragData };\nexport { getDragData };\nexport { dragCancelled };\nexport { secondsToMMSS };\nexport { inPlaceShuffle };\nexport { isAlphanumeric };\nexport { generateRandomID };\nexport { excludeMeSioEvent };","import React from 'react';\nimport { tileColors } from '../constants';\n\n\nconst Legend = () => {\n\n    return (\n        <div className=\"block\">\n            <div className=\"flex\">\n                <div title=\"A piece must be played on this tile at the beginning of the game\" className=\"flex-1\"><span className={`${tileColors[\"startTile\"]} pr-5 h-6 w-8 border-2 border-black`}></span><span className=\"pl-2\">Start Point</span></div>\n                <div title=\"The total score of the letter on this tile is doubled\" className=\"flex-1\"><span className={`${tileColors[\"doubleLetter\"]} pr-5 h-6 w-8 border-2 border-black`}></span><span className=\"pl-2\">Double Letter</span></div>\n                <div title=\"The total score of the letter on this tile is tripled\" className=\"flex-1\"><span className={`${tileColors[\"tripleLetter\"]} pr-5 h-6 w-8 border-2 border-black`}></span><span className=\"pl-2\">Triple Letter</span></div>\n                <div title=\"The total score of the word played is doubled when a piece is on this tile\" className=\"flex-1\"><span className={`${tileColors[\"doubleWord\"]} pr-5 h-6 w-8 border-2 border-black`}></span><span className=\"pl-2\">Double Word</span></div>\n                <div title=\"The total score of the word played is tripled when a piece is on this tile\" className=\"flex-1\"><span className={`${tileColors[\"tripleWord\"]} pr-5 h-6 w-8 border-2 border-black`}></span><span className=\"pl-2\">Triple Word</span></div>\n            </div>\n        </div>\n    )\n};\n\nexport default Legend;","// A scrabble piece\n\nimport React, { useState, useEffect, useRef, useContext } from 'react';\nimport { setDragData, dragCancelled } from '../utils';\nimport { ValidDragContext } from '../context';\n\n\nconst Piece = ({\n    id,\n    tileID,\n    char,\n    weight,\n    onBoard,\n    isPlayed,\n    isStatic,\n    isTransformed,\n    dragEndHandler,\n}) => {\n\n    const thisPiece = useRef();\n\n    const { validDrag, setValidDrag } = useContext(ValidDragContext);\n    const [pieceData, setPieceData] = useState({ id, tileID, char, weight, onBoard, isTransformed, isStatic, isPlayed });\n\n    // Event listeners handlers\n\n    // Call handler function on drag end\n    const handleDragEnd = (e) => {\n        e.stopImmediatePropagation();\n        if (dragEndHandler // Associated handling function\n            && validDrag.current // Drag is valid\n            && !dragCancelled(e)) //  Drag wasn't cancelled\n            dragEndHandler(pieceData)\n    };\n\n    // Save piece metadata on drag start\n    const handleDragStart = (e) => {\n        // Prevent bubble\n        e.stopPropagation();\n        e.stopImmediatePropagation();\n\n        setValidDrag(true) // Reset prev drag context\n        setDragData(e, pieceData); // Save piece data\n    };\n\n\n    // Pieces should not be dropped on pieces\n    const handleDragDrop = (e) => {\n        // Prevent bubble\n        e.preventDefault();\n        e.stopPropagation();\n        e.stopImmediatePropagation();\n        setValidDrag(false); // Prevent drag end update\n    }\n\n    // [Naturally], prevent default\n    const handleDragOver = (e) => e.preventDefault();\n    const handleDragEnter = (e) => e.preventDefault();\n    const handleDragLeave = (e) => e.preventDefault();\n\n\n    // Effect Listeners\n    useEffect(() => thisPiece.current.addEventListener(\"drop\", handleDragDrop));\n    useEffect(() => thisPiece.current.addEventListener(\"dragend\", handleDragEnd));\n    useEffect(() => thisPiece.current.addEventListener(\"dragover\", handleDragOver));\n    useEffect(() => thisPiece.current.addEventListener(\"dragleave\", handleDragLeave));\n    useEffect(() => thisPiece.current.addEventListener(\"dragstart\", handleDragStart));\n    useEffect(() => thisPiece.current.addEventListener(\"dragenter\", handleDragEnter));\n\n\n    // Custom class names depending on piece\n    let weightClassNames = pieceData.weight < 10 ? \"absolute relative right-0.5 bottom-0.5\" : \"absolute relative right-1.5 bottom-0.5\"\n    let classNames = `${isStatic ? \"h-3/4\" : \"h-full\"} ${isTransformed ? \"bg-yellow-300\" : \"\"} ${pieceData.char === \" \" ? \"flex-col-reverse\" : \"\"} cursor-pointer hover:text-gray-700 flex flex-col ${onBoard ? \"w-full\" : \"w-14 border\"} text-black bg-yellow-200 border-black`;\n\n    return (\n        <div ref={thisPiece} draggable={!isPlayed} className={classNames}>\n            <div className=\"block self-center w-4/5 text-4xl font-bold\">\n                <span style={{ top: \"0.4rem\" }} className={`absolute ${isTransformed ? \"italic pr-2\" : \"\"} relative`}>\n                    {pieceData.char}\n                </span>\n            </div>\n            <div className=\"block self-end w-1/5 text-xs\">\n                <span className={weightClassNames}>\n                    {pieceData.weight}\n                </span>\n            </div>\n        </div>\n    )\n};\n\nexport default Piece;","import React, { useState, useEffect, useRef, forwardRef, useImperativeHandle, useContext } from 'react';\nimport { GameContext, SocketIOContext } from '../context';\nimport { tileColors } from '../constants';\nimport { getDragData } from '../utils';\nimport { Star } from 'react-feather';\nimport Piece from './Piece';\n\nconst Tile = forwardRef((props, ref) => {\n\n    // The component instance will be extended\n    // with whatever you return from the callback passed\n    // as the second argument\n    useImperativeHandle(ref, () => ({\n\n        addPiece(piece) {\n            setPlayedPiece(piece);\n        },\n\n        removePiece() {\n            setPlayedPiece(null);\n        },\n\n        hasPiece() {\n            return playedPiece !== null && playedPiece !== undefined;\n        },\n\n        getPiece() {\n            return { ...playedPiece.props, tileType: props.type };\n        },\n\n    }));\n\n    let prevTileID = \"\";\n    const type = props.type;\n    const tileID = props.id;\n\n    const thisTile = useRef();\n    const sio = useContext(SocketIOContext);\n    const [playedPiece, setPlayedPiece] = useState(props.playedPiece);\n    const { player, playedTiles, usedTiles, setPlayedTiles } = useContext(GameContext);\n\n\n    // Helper functions \n\n    // On drag end, remove piece if necessary\n    // New tile will have newly-created piece\n    const dragEndHandler = (pieceData) => {\n        // If it isn't a cemented tile\n        if (!usedTiles.current.includes(pieceData.tileID)) {\n            if (prevTileID !== tileID) {\n                setPlayedPiece(null);\n            }\n        }\n    }\n\n    // Event listeners\n    const handleDragDrop = (e) => {\n        // Data of piece dragged on this tile      \n        const pieceData = getDragData(e);\n\n        // If it isn't a cemented tile\n        if (!usedTiles.current.includes(pieceData.tileID)) {\n            e.preventDefault();\n            e.stopPropagation();\n            e.stopImmediatePropagation();\n\n            let id = pieceData['id'];\n            let char = pieceData['char'];\n            let weight = pieceData['weight'];\n            let isTransformed = pieceData['isTransformed'];\n\n            // Keep the previous tile id\n            prevTileID = pieceData['tileID'];\n\n            if (char === \" \") {\n                // Initiate Show modal. Also save the original pieceID and this tileID\n                props.setRequestChoosePiece({ tileID: tileID, pieceID: id, status: true });\n            }\n            else {\n                // Off modal/Reset modal pipeline\n                props.setRequestChoosePiece({ tileID: \"\", pieceID: id, status: false });\n\n                let newPiece = <Piece\n                    id={id}\n                    char={char}\n                    onBoard={true}\n                    weight={weight}\n                    tileID={tileID}\n                    isTransformed={isTransformed}\n                    dragEndHandler={dragEndHandler}\n                />;\n\n                // Tell other players\n                sio.emit('inPlayEvent', {\n                    roomID: player.current.roomID,\n                    pieceData: {\n                        id,\n                        char,\n                        weight,\n                        tileID,\n                        prevTileID,\n                        isTransformed,\n                        onBoard: true,\n                    }\n                });\n                // Update parent with new tile-piece association\n                setPlayedTiles([...playedTiles.current, tileID]);\n                setPlayedPiece(newPiece); // Associate piece with Tile\n            }\n        }\n    }\n\n    const handleDragOver = (e) => e.preventDefault();\n    const handleDragEnter = (e) => e.preventDefault();\n    const handleDragLeave = (e) => e.preventDefault();\n\n\n    // Effects\n    // Use turn of player to register and unregister event handlers\n    // Essentially, turn off tile-listening ability if it's not player's\n    // turn; and, of course, turn it back on if it's his/her turn?\n    useEffect(() => {\n        if (player.current.turn) thisTile.current.addEventListener(\"drop\", handleDragDrop);\n        else thisTile.current.removeEventListener(\"drop\", handleDragDrop);\n        return () => thisTile.current.removeEventListener(\"drop\", handleDragDrop);\n    }, [player.current.turn]);\n\n    useEffect(() => {\n        if (player.current.turn) thisTile.current.addEventListener(\"dragover\", handleDragOver);\n        else thisTile.current.removeEventListener(\"dragover\", handleDragOver);\n        return () => thisTile.current.removeEventListener(\"dragover\", handleDragOver);\n    }, [player.current.turn]);\n\n    useEffect(() => {\n        if (player.current.turn) thisTile.current.addEventListener(\"dragleave\", handleDragLeave);\n        else thisTile.current.removeEventListener(\"dragleave\", handleDragLeave);\n        return () => thisTile.current.removeEventListener(\"dragleave\", handleDragLeave);\n    }, [player.current.turn]);\n\n    useEffect(() => {\n        if (player.current.turn) thisTile.current.addEventListener(\"dragenter\", handleDragEnter);\n        else thisTile.current.removeEventListener(\"dragenter\", handleDragEnter);\n        return () => thisTile.current.removeEventListener(\"dragenter\", handleDragEnter)\n    }, [player.current.turn]);\n\n\n    return (\n        <div id={tileID} ref={thisTile} className={`${tileColors[type]} flex flex-col justify-around items-center h-14 w-14 border border-black border-opacity-70`}>\n            {(props.type === \"startTile\") && !playedPiece ?\n                <div className=\"justify-center items-center\">\n                    <Star fill=\"white\" strokeWidth=\"0\" size={24} />\n                </div> : null}\n            {playedPiece}\n        </div>\n    )\n});\n\nexport default Tile;","import React, { useContext } from \"react\";\nimport { GameContext } from \"../context\";\nimport Piece from \"./Piece\";\n\nexport default function Modal(props) {\n    const { bag } = useContext(GameContext);\n\n    let modal =\n        props.mode === \"chooseLetter\" // Choose a letter\n            ? <>\n                <div className=\"justify-center items-center flex overflow-x-hidden overflow-y-auto fixed inset-0 z-50 outline-none focus:outline-none\">\n                    <div className=\"relative w-auto my-6 mx-auto max-w-3xl\">\n                        <div className=\"border-0 rounded-lg shadow-lg relative flex flex-col w-full bg-white outline-none focus:outline-none\">\n                            <div className=\"flex justify-center flex-col pt-7 p-3 border-b border-solid border-blueGray-200 rounded-t\">\n                                <h3 className=\"text-2xl font-semibold\">\n                                    Wildcard Transformation\n                                </h3>\n                                <div className=\"text-md pt-1 text-gray-500\">Choose a piece to replace the wildcard with</div>\n                            </div>\n                            <div className=\"relative pt-7 p-10 flex justify-center flex-wrap\">\n                                {\n                                    Object.values(bag.current.pieces).filter((piece) => piece.piece !== \" \").map((piece, index) => {\n                                        return (\n                                            <div key={index} onClick={() => props.modalHandler(piece.piece)} className=\"mx-4 my-4\">\n                                                <Piece char={piece.piece} weight={0} />\n                                            </div>\n                                        );\n                                    })\n                                }\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div className=\"opacity-75 fixed inset-0 z-40 bg-black\"></div>\n            </>\n            : // Normal showing on bag click\n            <>\n                <div className=\"justify-center items-center flex overflow-x-hidden overflow-y-auto fixed inset-0 z-50 outline-none focus:outline-none\">\n                    <div className=\"relative w-auto my-6 mx-auto max-w-3xl\">\n                        <div className=\"border-0 rounded-lg shadow-lg relative flex flex-col w-full bg-white outline-none focus:outline-none\">\n                            <div className=\"flex items-start justify-center pt-5 p-4 border-b border-solid border-blueGray-200 rounded-t\">\n                                <h3 className=\"text-2xl font-semibold\">\n                                    Contents of the Scrabble Bag\n                                </h3>\n                            </div>\n                            <div className=\"relative pt-7 p-10 flex justify-center flex-wrap\">\n                                {\n                                    Object.values(bag.current.pieces).map((piece, index) => {\n                                        return (\n                                            <div key={index} className=\"mx-4 my-4\">\n                                                <Piece isStatic={true} char={piece.piece} weight={piece.weight} />\n                                                <div className=\"self-center mt-1 text-xs text-gray-900\">\n                                                    {piece.number} left\n                                                </div>\n                                            </div>\n                                        );\n                                    })\n                                }\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div className=\"opacity-75 fixed inset-0 z-40 bg-black\"></div>\n            </>\n\n    return (props.show ? modal : null);\n}","import axios from 'axios';\nimport { API_URL, SERVER_TOKEN } from './constants'\n\naxios.defaults.baseURL = API_URL;\naxios.defaults.headers.post['Content-Type'] = 'application/json';\naxios.defaults.headers.common['Authorization'] = `Bearer ${SERVER_TOKEN}`;\n\naxios.interceptors.request.use(request => {\n    // console.log(request);\n    // Edit request config\n    return request;\n}, error => {\n    console.log(error);\n    return Promise.reject(error);\n});\n\naxios.interceptors.response.use(response => {\n    // console.log(response);\n    // Edit response config\n    return response;\n}, error => {\n    console.log(error);\n    return Promise.reject(error);\n});\n\nconst makeServerRequest = (opts) => {\n    // Payload is params for GET and same for POST\n    return axios[opts.requestType](opts.url, opts.payload)\n        .then(r => r.data)\n        .catch(e => console.log(e.data));\n}\n\nexport default makeServerRequest;","import { useEffect, useRef, useState, useCallback } from 'react';\nimport makeServerRequest from './xhr';\n\n\nfunction useFetch(requestParams) {\n    const [data, setData] = useState();\n\n    useEffect(() => {\n        const goGet = async () => {\n            const response = await makeServerRequest(requestParams);\n            setData(response);\n        }\n        goGet();\n    }, [requestParams.url]);\n    return data;\n}\n\n\nfunction useStateRef(defaultValue) {\n    let [state, setState] = useState(defaultValue)\n    let ref = useRef(state)\n\n    let dispatch = useCallback(function (val) {\n        ref.current = typeof val === \"function\" ?\n            val(ref.current) : val\n\n        setState(ref.current)\n    }, []);\n\n    return [state, dispatch, ref]\n}\n\nconst reducer = (state, action) => {\n    switch (action.type) {\n      case true: return true \n      default: return false\n     }\n  }\n\nfunction useEventListener(eventName, handler, element = window) {\n    const savedHandler = useRef();\n\n    useEffect(() => {\n        savedHandler.current = handler;\n    }, [handler]);\n\n    useEffect(\n        () => {\n            // Make sure element supports addEventListener\n            const isSupported = element && element.addEventListener;\n            if (!isSupported) return;\n            // Create event listener that calls handler function stored in ref\n            const eventListener = (event) => savedHandler.current(event);\n            // Add event listener\n            element.addEventListener(eventName, eventListener);\n            // Remove event listener on cleanup\n            return () => {\n                element.removeEventListener(eventName, eventListener);\n            };\n        },\n        [eventName, element] // Re-run if eventName or element changes\n    );\n}\n\nexport { reducer };\nexport { useFetch };\nexport { useStateRef };\nexport { useEventListener };","import React, { useContext, useState, useEffect, useRef } from 'react';\nimport { GameContext, SocketIOContext } from '../context';\nimport { excludeMeSioEvent } from '../utils';\nimport Legend from './Legend';\nimport Piece from './Piece';\nimport Tile from './Tile';\nimport Modal from './Modal';\nimport { useStateRef } from '../hooks';\nimport { timeoutDelay } from '../constants';\n\n\n// 15 tiles per row\nconst tilePerRow = 15;\nconst GameBoard = (props) => {\n\n    let rows = [];\n    const tileRefs = useRef([]);\n    const [pingIntervalID, setPingIntervalID] = useState();\n\n    const sio = useContext(SocketIOContext);\n    const [_, setRequestChoosePiece, requestChoosePiece] = useStateRef({ tileID: \"\", pieceID: \"\", status: false });\n    const { player, playFlag, setUsedTiles, setBoardState, usedTiles, setPlayFlag, playedTiles, setPlayedWords, setPlayedTiles, recallFlag, setRecallFlag } = useContext(GameContext);\n\n\n    // Register Event Listeners\n    useEffect(() => {\n        const dispatch = ({ pieceData }) => {\n            let newPiece = <Piece\n                isPlayed={false}\n                id={pieceData.id}\n                char={pieceData.char}\n                weight={pieceData.weight}\n                tileID={pieceData.tileID}\n                onBoard={pieceData.onBoard}\n                isTransformed={pieceData.isTransformed}\n            />;\n\n            // [Board/Rack]-Rack. Piece diasppears. Ensure other player's played tiles cannot be dragged to own rack\n            if (pieceData.toRackMove) {\n                if (pieceData.tileID && !usedTiles.current.includes(pieceData.tileID)) {\n                    // Board-Rack. Remove from board\n                    removePieceFromTile(pieceData.tileID);\n                    setPlayedTiles(playedTiles.current.filter((tID) => tID !== pieceData.tileID));\n                    // Rack-Rack. Do nothing.\n                }\n            }\n            // [Rack/Board]-Board. Piece appears\n            else {\n                // If previous piece, remove it. (Board-Board)\n                if (pieceData.prevTileID) {\n                    removePieceFromTile(pieceData.prevTileID);\n                    setPlayedTiles(playedTiles.current.filter((tID) => tID !== pieceData.prevTileID))\n                }\n                // Eventually add new piece ([Rack/Board]-Board)\n                addPieceToTile(pieceData.tileID, newPiece);\n\n                // Save played tiles if it's not me that played. Incase the player calls a recall\n                if (!player.current.turn) setPlayedTiles([...playedTiles.current, pieceData.tileID]);\n            }\n        }\n\n        // Add played piece to board for every player\n        excludeMeSioEvent(sio, \"inPlay\", player.current.name, dispatch)\n    }, [player.current]);\n\n\n    // Register Event Listeners\n    useEffect(() => {\n        // Recall pieces for every player except me\n        const dispatch = (data) => setRecallFlag(true);\n        excludeMeSioEvent(sio, \"recallPieces\", player.current.name, dispatch)\n    }, [player.current]);\n\n\n    // Remove tile pieces if recall is pressed on Rack\n    useEffect(() => {\n        if (recallFlag.current) {\n            for (const tileID of playedTiles.current) {\n                removePieceFromTile(tileID);\n            }\n            setRecallFlag(false);\n            setPlayedTiles([]);\n        }\n    }, [recallFlag.current]);\n\n\n    // Remove tile pieces if recall is pressed on Rack\n    useEffect(() => {\n        if (playFlag.current) {\n            setPlayedWords(getPlayedWords());\n            setPlayFlag(false);\n        }\n    }, [playFlag.current]);\n\n\n    // Create new ref to each tile until all tiles have been referenced\n    useEffect(() => {\n        tileRefs.current = Array(rows.length * tilePerRow)\n            .fill().map((_, i) => tileRefs.current[i]);\n    }, [rows.length]);\n\n\n    // Create all tiles\n    for (let index = 0; index < tilePerRow; index++) {\n        let tileRows = [];\n        let tileRow = (index * tilePerRow);\n\n        if (index === 0 || index === 14) {\n            for (let i = 0; i < tilePerRow; i++) {\n                let tileType = \"normal\";\n                if (i === 3 || i === 11) tileType = \"doubleLetter\";\n                if (i === 0 || i === 7 || i === 14) tileType = \"tripleWord\";\n                let tile = <Tile\n                    type={tileType}\n                    id={tileRow + i}\n                    setRequestChoosePiece={setRequestChoosePiece}\n                    key={tileRow + i}\n                    ref={el => tileRefs.current[tileRow + i] = el}\n                />;\n                tileRows.push(tile);\n            }\n        }\n        if (index === 1 || index === 13) {\n            for (let i = 0; i < tilePerRow; i++) {\n                let tileType = \"normal\";\n                if (i === 1 || i === 13) tileType = \"doubleWord\";\n                if (i === 5 || i === 9) tileType = \"tripleLetter\";\n                let tile = <Tile\n                    type={tileType}\n                    id={tileRow + i}\n                    setRequestChoosePiece={setRequestChoosePiece}\n                    key={tileRow + i}\n                    ref={el => tileRefs.current[tileRow + i] = el}\n                />;\n                tileRows.push(tile);\n            }\n        }\n        if (index === 2 || index === 12) {\n            for (let i = 0; i < tilePerRow; i++) {\n                let tileType = \"normal\";\n                if (i === 2 || i === 12) tileType = \"doubleWord\";\n                if (i === 6 || i === 8) tileType = \"doubleLetter\";\n                let tile = <Tile\n                    type={tileType}\n                    id={tileRow + i}\n                    setRequestChoosePiece={setRequestChoosePiece}\n                    key={tileRow + i}\n                    ref={el => tileRefs.current[tileRow + i] = el}\n                />;\n                tileRows.push(tile);\n            }\n        }\n        if (index === 3 || index === 11) {\n            for (let i = 0; i < tilePerRow; i++) {\n                let tileType = \"normal\";\n                if (i === 3 || i === 11) tileType = \"doubleWord\";\n                if (i === 0 || i === 7 || i === 14) tileType = \"doubleLetter\";\n                let tile = <Tile\n                    type={tileType}\n                    id={tileRow + i}\n                    setRequestChoosePiece={setRequestChoosePiece}\n                    key={tileRow + i}\n                    ref={el => tileRefs.current[tileRow + i] = el}\n                />;\n                tileRows.push(tile);\n            }\n        }\n        if (index === 4 || index === 10) {\n            for (let i = 0; i < tilePerRow; i++) {\n                let tileType = \"normal\";\n                if (i === 4 || i === 10) tileType = \"doubleWord\";\n                let tile = <Tile\n                    type={tileType}\n                    id={tileRow + i}\n                    setRequestChoosePiece={setRequestChoosePiece}\n                    key={tileRow + i}\n                    ref={el => tileRefs.current[tileRow + i] = el}\n                />;\n                tileRows.push(tile);\n            }\n        }\n        if (index === 5 || index === 9) {\n            for (let i = 0; i < tilePerRow; i++) {\n                let tileType = \"normal\";\n                if (i === 5 || i === 9 || i === 1 || i === 13) tileType = \"tripleLetter\";\n                let tile = <Tile\n                    type={tileType}\n                    id={tileRow + i}\n                    setRequestChoosePiece={setRequestChoosePiece}\n                    key={tileRow + i}\n                    ref={el => tileRefs.current[tileRow + i] = el}\n                />;\n                tileRows.push(tile);\n            }\n        }\n        if (index === 6 || index === 8) {\n            for (let i = 0; i < tilePerRow; i++) {\n                let tileType = \"normal\";\n                if (i === 2 || i === 6 || i === 8 || i === 12) tileType = \"doubleLetter\";\n                let tile = <Tile\n                    type={tileType}\n                    id={tileRow + i}\n                    setRequestChoosePiece={setRequestChoosePiece}\n                    key={tileRow + i}\n                    ref={el => tileRefs.current[tileRow + i] = el}\n                />;\n                tileRows.push(tile);\n            }\n        }\n        if (index === 7) {\n            for (let i = 0; i < tilePerRow; i++) {\n                let tileType = \"normal\";\n                if (i === 7) tileType = \"startTile\";\n                if (i === 0 || i === 14) tileType = \"tripleWord\";\n                if (i === 3 || i === 11) tileType = \"doubleLetter\";\n                let tile = <Tile\n                    type={tileType}\n                    id={tileRow + i}\n                    key={tileRow + i}\n                    setRequestChoosePiece={setRequestChoosePiece}\n                    ref={el => tileRefs.current[tileRow + i] = el}\n                />;\n                tileRows.push(tile);\n            }\n        }\n\n        // Push the entire tile row\n        rows.push(<div className=\"flex border-opacity-100\" key={index}> {tileRows} </div>);\n    }\n\n\n    const getTile = (refIndex) => tileRefs.current[refIndex];\n    const removePieceFromTile = (refIndex) => getTile(refIndex).removePiece();\n    const addPieceToTile = (refIndex, piece) => getTile(refIndex).addPiece(piece);\n\n\n    // Returns if a passed in tile and position is at\n    // the edge of the board in said position\n    const isBoardEdge = (position, index) => {\n        if (position === 'top') {\n            return index >= 0 && index < 15;\n        }\n        else if (position === 'bottom') {\n            return index > 209 && index < 225;\n        }\n        else if (position === 'left') {\n            return (index % 15) === 0;\n        }\n        else { // Implicit right\n            return (index % 15) === 14;\n        }\n    }\n\n\n    // Get words that were played\n    const getPlayedWords = () => {\n        let wv, wh, words = [];\n\n        for (const tileIndex of playedTiles.current) {\n            let thisTile = getTile(tileIndex).getPiece();\n\n            // Get words at the left, right, top, and bottom\n            let wordsTop = getPiecesInPosition(tileIndex, \"top\");\n            let wordsLeft = getPiecesInPosition(tileIndex, \"left\");\n            let wordsDown = getPiecesInPosition(tileIndex, \"bottom\");\n            let wordsRight = getPiecesInPosition(tileIndex, \"right\");\n\n            // English words are read left-right/top-bottom. \n            // Extract in same manner\n            wv = [...wordsTop, thisTile, ...wordsDown];\n            wh = [...wordsLeft, thisTile, ...wordsRight];\n\n            // Skip the empty and single words\n            if (wv.length > 1) words.push(wv);\n            if (wh.length > 1) words.push(wh);\n        }\n\n        // Return non-duplicates\n        return words.filter((v, i, a) => a.findIndex(t => (JSON.stringify(t) === JSON.stringify(v))) === i);\n    }\n\n\n    // Returns the word(s) at the position of the piece at index\n    const getPiecesInPosition = (index, position) => {\n        let ind, loopLength, words = [];\n\n        if (position === \"right\" || position === \"left\") loopLength = 1;\n        else loopLength = 15; // Implicit top or down\n\n        if (isBoardEdge(position, index)) return words;\n\n        while (true) {\n            // Go forward for right and down. Go backwards, otherwise\n            if (position === \"right\" || position === \"bottom\") ind = index + loopLength\n            else ind = index - loopLength;\n\n            let tile = getTile(ind); // Get the tile at said index on board\n\n            if (tile.hasPiece()) {\n                // Right and below should be appended to the end of th word list.\n                // Left and above should be prepended.\n                if (position === \"right\" || position === \"bottom\") words.push(tile.getPiece())\n                else words.unshift(tile.getPiece());\n\n                if (position === \"right\" || position === \"left\") loopLength += 1\n                else loopLength += 15;\n\n                // After getting the piece, check if the piece is at\n                // the edge of the board. If it is, then exit, as there\n                // will be nothing in the next position.\n                if (isBoardEdge(position, ind)) break;\n            }\n            else break;\n        }\n\n        return words\n    }\n\n\n    // Handle modal for choosing letter\n    const modalHandler = (piece) => {\n\n        // Create a transformed blank piece\n        let transformedBlankPiece = <Piece\n            // isPlayed={true}\n            weight={0}\n            char={piece}\n            onBoard={true}\n            isTransformed={true}\n            id={requestChoosePiece.current.pieceID}\n            tileID={requestChoosePiece.current.tileID}\n        />;\n\n        // Add piece to tile\n        addPieceToTile(requestChoosePiece.current.tileID, transformedBlankPiece);\n\n        // Tell parent for possible removal\n        setPlayedTiles([...playedTiles.current, requestChoosePiece.current.tileID]);\n\n        // Tell other players\n        sio.emit('inPlayEvent', {\n            roomID: player.current.roomID,\n            pieceData: {\n                weight: 0,\n                char: piece,\n                onBoard: true,\n                isTransformed: true,\n                id: requestChoosePiece.current.pieceID,\n                tileID: requestChoosePiece.current.tileID,\n            }\n        });\n\n        // Switch Off modal\n        setRequestChoosePiece({ tileID: \"\", pieceID: \"\", status: false });\n    }\n\n\n    // Save board state in interval (autosave)\n    useEffect(() => {\n        let iID = setInterval(() => {\n            if (usedTiles.current.length > 0) {\n                let state = [];\n                for (const tileIndex of usedTiles.current) {\n                    state.push(getTile(tileIndex).getPiece());\n                }\n                setBoardState(state);\n            };\n        }, timeoutDelay);\n\n        setPingIntervalID(iID);\n        return () => clearInterval(pingIntervalID);\n    }, []); // [] Ensures only on first render\n\n\n    // Save board state\n    // [Hacky]: Use data in current used tiles to\n    // restore all pieces; after, restore the used\n    // tiles to contain only tileIDs, as is normal\n    useEffect(() => {\n        if (usedTiles.current.length > 0) {\n            // Add all played pieces to tile\n            for (const piece of usedTiles.current) {\n                let playedPiece = <Piece\n                    id={piece.id}\n                    onBoard={true}\n                    isPlayed={true}\n                    char={piece.char}\n                    weight={piece.weight}\n                    tileID={piece.tileID}\n                    isTransformed={piece.isTransformed}\n                />;\n                addPieceToTile(piece.tileID, playedPiece);\n            }\n            // Rewrite used tiles to store only tileIDs\n            setUsedTiles(usedTiles.current.map(t => t.tileID));\n        }\n    }, []); // [] Ensures only on first render\n\n\n    return (\n        <div className=\"space-y-4 \">\n            <div style={{ height: \"fit-content\" }} className=\"block border-8 border-black rounded-md\"> {rows} </div>\n            <Legend />\n            <Modal modalHandler={modalHandler} mode=\"chooseLetter\" show={requestChoosePiece.current.status} />\n        </div>\n    )\n};\n\nexport default GameBoard;","import React, { useState, useEffect, useContext } from 'react';\nimport { Wifi, WifiOff, Save } from 'react-feather';\nimport makeServerRequest from '../xhr';\nimport { GameContext } from '../context';\nimport { timeoutDelay } from '../constants';\n\nconst iconSize = 26;\n\nconst Connection = (props) => {\n    let icon, iconStatus;\n\n    // State\n    const [ping, setPing] = useState(1);\n    const [status, setStatus] = useState(\"on\");\n    const [showSave, setShowSave] = useState(false);\n    const [pingIntervalID, setPingIntervalID] = useState();\n    const { player, boardState, rackState } = useContext(GameContext);\n\n\n    // Server ping\n    useEffect(() => {\n        let iID = setInterval(() => {\n            pingServer();\n            saveGame();\n        }, timeoutDelay);\n\n        setPingIntervalID(iID);\n        return () => clearInterval(pingIntervalID);\n\n    }, []); // [] ensures only on first render\n\n\n    // Server ping duration\n    const pingServer = async () => {\n        let startTime = new Date(); // Record start time\n\n        // Make request\n        let response = await makeServerRequest({ requestType: 'get', url: `/ping`, payload: {} });\n\n        // If successful\n        if (response && response.status === \"pingSuccess\") {\n            let endTime = new Date(); // Record end time\n\n            let pingDuration = endTime.getTime() - startTime.getTime();\n            setPing(pingDuration); // Save difference\n\n            // Set Icon\n            if (pingDuration < 120) setStatus(\"on\");\n            else if (pingDuration < 500) setStatus(\"warning\");\n            else setStatus(\"off\");\n        }\n        else setStatus(\"off\");\n    }\n\n\n    // Save board and player rack\n    const saveGame = async () => {\n        setShowSave(true);\n\n        let payload = {\n            player: player.current,\n            rack: rackState.current,\n            board: boardState.current,\n            roomID: player.current.roomID,\n        }\n\n        let response = await makeServerRequest({ requestType: 'post', url: `/cache`, payload: payload });\n\n        // If successful\n        if (response && response.status === \"success\") {\n            // Nice\n        }\n\n        setTimeout(() => {\n            setShowSave(false);\n        }, 2000);\n    }\n\n\n    // Determine icon\n    if (status === \"on\") {\n        iconStatus = \"Connection is good\";\n        icon = <Wifi size={iconSize} color=\"#1fe03d\" />;\n    }\n    else if (status === \"off\") {\n        iconStatus = \"Server disconnected. Trying to reconnect\";\n        icon = <WifiOff size={iconSize} color=\"#f32b0c\" />;\n    }\n    else {\n        icon = <Wifi size={iconSize} color=\"#ffd100\" />\n        iconStatus = \"Connection is poor. Delays may occur\";\n    }\n\n    return (\n        <div className=\"flex justify-between items-center\">\n            <div className=\"flex space-x-1 flex-none text-gray-400\">\n                {showSave ? <>\n                    <div className=\"cursor-help flex-none\"><Save size={23} /></div>\n                    <div>Saving...</div></>\n                    : null}\n            </div>\n            <div className=\"flex space-x-1\">\n                <div title={iconStatus} className=\"cursor-help flex-none\">{icon}</div>\n                <div title=\"Server ping\" className=\"cursor-help flex-none text-gray-500\">{ping}ms</div>\n            </div>\n        </div>\n\n    );\n};\n\nexport default Connection;","import { Volume2, Radio, Mic, User } from 'react-feather';\nimport React, { useContext, useEffect } from 'react';\nimport { GameContext } from '../context';\nimport { useStateRef } from '../hooks';\nimport { countUp } from '../utils';\n\n\nconst ScoreBoard = () => {\n\n    const [_, setBoard, board] = useStateRef([]);\n    const { player, players } = useContext(GameContext);\n    \n    useEffect(() => {\n        let tableRows = [];\n        for (const [index, p] of players.current.entries()) {\n            let tableRow = <tr key={index}>\n                <td className={`text-left capitalize border ${p.turn ? \"font-bold\" : \"\"} border-gray-300 px-4 py-2 text-black-600 font-medium`}>\n                    {p.name}\n                    <span className=\"inline pl-1\">{player.current.name === p.name ? <span title={`This is You${p.turn ? \". It's also your turn to play\" : \"\"}`}><User title=\"You\" size={22} className=\"inline pb-1\" fill=\"black\" strokeWidth={1} /> </span> : null}</span>\n                    <span className=\"inline\">{p.isSpeaking ? <span title=\"This person is currently recording\"> <Radio size={22} className=\"inline pb-1\" /></span> : null}</span>\n                </td>\n                <td className=\"border border-gray-300 px-4 py-2 text-black-600 font-medium\">{countUp(p.score)}</td>\n            </tr>\n            tableRows.push(tableRow);\n        }\n        setBoard(tableRows);\n    }, [player.current, players.current]);\n\n    return (\n        <div className=\"flex justify-end\">\n            <table className=\"table-auto w-80\">\n                <thead>\n                    <tr className=\"bg-gray-100\">\n                        <th className=\"text-left border border-gray-300 px-4 py-2 text-black-600\">Player</th>\n                        <th className=\"border border-gray-300 px-4 py-2 text-black-600\">Score</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {board.current}\n                </tbody>\n            </table>\n        </div>\n    )\n};\n\nexport default ScoreBoard;","import React, { useContext, useEffect } from 'react';\nimport { AlertCircle, Bell, } from 'react-feather';\nimport { NotificationContext } from '../context';\nimport { useStateRef } from '../hooks';\n\nconst Notification = (props) => {\n\n    // let ns = [];\n    const { notifications } = useContext(NotificationContext);\n    const [_, setTimeoutNotifications, timeoutNotifications] = useStateRef([]);\n\n    useEffect(() => {\n        for (const [index, notification] of notifications.current.entries()) {\n\n            let classNames, iconType;\n\n            if (notification.type === \"info\") {\n                iconType = <AlertCircle size={22} />;\n                classNames = \"bg-blue-100 flex items-center border border-blue-300 text-blue-900 px-4 py-4 rounded relative\";\n            }\n            else if (notification.type === \"success\") {\n                iconType = <Bell size={22} />;\n                classNames = \"bg-green-100 flex items-center border border-green-300 text-green-800 px-4 py-4 rounded relative\";\n            }\n            else if (notification.type === \"error\") {\n                iconType = <AlertCircle size={22} />;\n                classNames = \"bg-red-100 flex items-center border border-red-300 text-red-800 px-4 py-4 rounded relative\";\n            }\n            else if (notification.type === \"warning\") {\n                iconType = <AlertCircle size={22} />;\n                classNames = \"bg-yellow-100 flex items-center border border-yellow-300 text-yellow-800 px-4 py-4 rounded relative\";\n            }\n            else {\n                iconType = <Bell size={22} />;\n                classNames = \"bg-center-100 flex items-center text-white center-500 text-center-800 px-4 py-4 rounded relative\";\n            }\n\n            let newNotification = <div key={index}>\n                <div className={classNames}>\n                    <span className=\"inline pr-4\">{iconType}</span>\n                    <span className=\"inline text-left\">{notification.message}</span>\n                </div>\n                <div className=\"pb-2\"></div>\n            </div>;\n\n            // Add to state\n            setTimeoutNotifications([newNotification]);\n        }\n    }, [notifications.current]);\n\n    return (timeoutNotifications.current)\n};\n\nexport default Notification;","import React, { useRef, useEffect } from \"react\";\nimport { useStateRef } from \"../hooks\";\nimport Piece from \"./Piece\";\nimport { Check, X } from \"react-feather\";\n\nexport default function SwapModal(props) {\n\n    const checkBoxRefs = useRef([]);\n    const [_, setShowConfirm, showConfirm] = useStateRef(false);\n\n    // Create new ref to each tile until all tiles have been referenced\n    useEffect(() => {\n        checkBoxRefs.current = Array(props.pieces.length)\n            .fill().map((_, i) => checkBoxRefs.current[i]);\n    }, [props.pieces.length]);\n\n\n    const handleOnChange = (e) => {\n        let checkedBoxes = checkBoxRefs.current.filter((checkBox) => checkBox.checked === true);\n        if (checkedBoxes.length > 0) setShowConfirm(true)\n        else setShowConfirm(false);\n    }\n\n    // Only need the IDs to swap pieces\n    const getCheckedBoxesIDs = () => {\n        let checkedBoxes = [];\n        for (const checkBox of checkBoxRefs.current) {\n            if (checkBox.checked === true) checkedBoxes.push(checkBox.id);\n        }\n        return checkedBoxes;\n    }\n\n    return props.show ? <>\n        <div className=\"justify-center items-center flex overflow-x-hidden overflow-y-auto fixed inset-0 z-50 outline-none focus:outline-none\">\n            <div className=\"relative w-auto my-6 mx-auto max-w-3xl\">\n                <div className=\"border-0 rounded-lg shadow-lg relative flex flex-col w-full bg-white outline-none focus:outline-none\">\n                    <div className=\"flex justify-center flex-col pt-7 p-3 border-b border-solid border-blueGray-200 rounded-t\">\n                        <h3 className=\"text-2xl font-semibold\">\n                            Exchange Pieces for a Turn\n                        </h3>\n                        <div className=\"text-md pt-1 text-gray-500\">Use the checkboxes to select the pieces to swap</div>\n                    </div>\n                    <div className=\"relative flex flex-col p-10 pb-9 pt-8 flex justify-center flex-wrap\">\n                        <div className=\"flex justify-center block\">{\n                            props.pieces.map((piece, index) => {\n                                return (\n                                    <div key={index} className=\"mx-4 my-4 mt-2\">\n                                        <Piece isStatic={true} char={piece.piece} weight={piece.weight} />\n                                        <div className=\"self-center mt-1 text-xs text-gray-900\">\n                                            <label className=\"inline-flex items-center\">\n                                                <input onChange={handleOnChange} id={piece.id} ref={el => checkBoxRefs.current[index] = el} type=\"checkbox\" />\n                                            </label>\n                                        </div>\n                                    </div>\n                                );\n                            })\n                        }\n                        </div>\n                        <div className=\"my-4 mb-2 space-x-6 block\">\n                            <button onClick={() => { setShowConfirm(false); props.swapCancelHandler() }} className=\"w-32 bg-red-600 hover:bg-red-700 text-white inline font-bold py-2 px-4 border border-red-700 rounded\">\n                                <X className=\"inline\" strokeWidth={3} size={22} />\n                                <span className=\"pl-1 pr-2 text-md\">Cancel</span>\n                            </button>\n                            {showConfirm.current ? <button onClick={() => { props.swapConfirmHandler(getCheckedBoxesIDs()) }} className=\"w-36 bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 border border-green-700 rounded\">\n                                <Check className=\"inline\" strokeWidth={3} size={22} />\n                                <span className=\"pl-1 pr-2 text-md\">Confirm</span>\n                            </button> : null}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div className=\"opacity-75 fixed inset-0 z-40 bg-black\"></div>\n    </> : null\n}","import React from 'react';\nimport { RotateCcw, Play, Shuffle, Repeat, SkipForward, Loader } from 'react-feather';\n\nconst descriptions = {\n    \"play\": \"Play as turn\",\n    \"shuffle\": \"Shuffle pieces on Rack\",\n    \"recall\": \"Recall played pieces\",\n    \"swap\": \"Swap pieces in place of turn\",\n    \"skip\": \"Skip turn\",\n    \"draw\": \"Start the game\",\n}\n\nconst ControlButton = ({ type, size, handler }) => {\n    let icon, className;\n\n    // Set css class\n    if (type === \"play\") {\n        className = \"flex justify-center items-center hover:border-l-2 hover:border-green-600 bg-green-500 hover:bg-green-700 text-white font-bold w-12 h-12 border-green-600 hover:border-green-500\";\n    }\n    else if (type === \"draw\") {\n        className = \"flex justify-center items-center hover:border-l-2 hover:border-yellow-300 bg-yellow-200 hover:bg-yellow-300 text-black font-normal px-10 w-12 h-12 border-2 border-yellow-300 hover:border-yellow-300\";\n    }\n    else {\n        className = \"flex justify-center items-center bg-blue-600 border-r-2 border-blue-700  hover:bg-blue-700 text-white font-bold w-12 h-12 border-blue-600 hover:border-blue-700\";\n    }\n\n    // Set button icon\n    if (type === \"recall\") icon = <RotateCcw strokeWidth=\"2.5\" size={size} />\n    else if (type === \"play\") icon = <Play fill=\"white\" strokeWidth=\"2.5\" size={size} />\n    else if (type === \"shuffle\") icon = <Shuffle strokeWidth=\"2.5\" size={size} />\n    else if (type === \"swap\") icon = <Repeat strokeWidth=\"2.5\" size={size} />\n    else if (type === \"skip\") icon = <SkipForward strokeWidth=\"2.5\" size={size} />\n    else if (type === \"draw\") icon = \"Draw\"\n\n    const loader = <button className={`${className}`}>\n        <Loader strokeWidth={3} size={22} className=\"animate-spin\" />\n    </button>\n\n    return (\n        <button title={descriptions[type]} className={`${className}`} onClick={handler}>\n            {icon}\n        </button>\n    )\n}\n\nexport default ControlButton;","import { useContext, useEffect } from \"react\";\nimport { useReactMediaRecorder } from \"react-media-recorder\";\nimport { GameContext, SocketIOContext } from \"../context\";\nimport { Mic, MicOff } from \"react-feather\";\nimport { useStateRef } from \"../hooks\";\n\n\n\nconst Audio = () => {\n    const {\n        mediaBlobUrl,\n        clearBlobUrl,\n        stopRecording,\n        startRecording,\n    } = useReactMediaRecorder({ audio: { type: \"audio/ogg\" }, askPermissionOnMount: true });\n\n\n    const sio = useContext(SocketIOContext);\n    const [_, setIsMuted, isMuted] = useStateRef(true);\n    const [__, setAudioBlob, audioBlob] = useStateRef(null);\n    const [___, setSpeakerName, speakerName] = useStateRef(\"\");\n    const { player, setPlayer, players, setPlayers } = useContext(GameContext);\n\n\n    const toggleAudioMute = () => {\n        isMuted.current === false ? setIsMuted(true) : setIsMuted(false);\n    }\n\n    const transmitAudio = () => {\n        clearBlobUrl(); // Clear any blob\n        startRecording(); // Start audio\n        stopRecording(); // Stop audio\n    }\n\n    useEffect(() => {\n        if (!isMuted.current) {\n            transmitAudio();\n            setPlayer({ ...player.current, isSpeaking: true });\n        }\n        else {\n            stopRecording();\n            setPlayer({ ...player.current, isSpeaking: false });\n        }\n\n        sio.emit(\"radioEvent\", {\n            audioBlob: mediaBlobUrl,\n            roomID: player.current.roomID,\n            speakerName: player.current.name,\n            isSpeaking: player.current.isSpeaking,\n        });\n\n    }, [mediaBlobUrl, isMuted.current]);\n\n\n    useEffect(() => {\n        sio.on(\"audioTransmission\", (data) => {\n            // Update other players\n            let updatedPlayers = [];\n            for (const p of players.current) {\n                if (data.speakerName === p.name) {\n                    if (data.isSpeaking) p['isSpeaking'] = true;\n                    else p['isSpeaking'] = false;\n                }\n                updatedPlayers.push(p);\n            }\n\n            setAudioBlob(null);\n            setPlayers(updatedPlayers);\n            setAudioBlob(data.audioBlob);\n            setSpeakerName(data.speakerName);\n        });\n    }, []);\n\n\n    return (\n        <div>\n            <button\n                title={isMuted.current ? \"Audio off. Click to record\" : \"Audio is recording. Click to stop\"}\n                onClick={toggleAudioMute}\n                className=\"flex justify-center items-center hover:border bg-yellow-200 hover:bg-yellow-300 text-white font-bold w-12 h-12 border border-yellow-400 hover:border-yellow-200\">\n                {isMuted.current ? <MicOff color=\"black\" strokeWidth=\"2.5\" size={20} /> : <Mic color=\"black\" strokeWidth=\"2.5\" size={20} />}\n            </button>\n\n            {/* Only play audio that doesn't originate from me */}\n            {!player.current.isSpeaking // I'm not speaking\n                && audioBlob.current    // Theres' audio to play\n                && speakerName.current !== player.current.name // Audio isn't mine\n                ? <audio className=\"hidden\" src={audioBlob.current} autoPlay />  // Create element and play\n                : null\n            }\n        </div>\n    );\n};\n\nexport default Audio;","import React, { useContext, useEffect } from 'react';\nimport ControlButton from './ControlButton';\nimport Audio from './Audio';\nimport { GameContext } from '../context';\nimport { useStateRef } from '../hooks';\n\nconst iconSize = 20;\n\n\nconst Controls = (props) => {\n    const { player, gameStarted, allowAudio } = useContext(GameContext);\n    const [_, setControlButtons, controlButtons] = useStateRef([]);\n\n    useEffect(() => {\n        let buttons = [];\n        // Push global buttons\n        for (const [index, type] of [\"recall\", \"shuffle\", \"swap\", \"skip\", \"play\"].entries()) {\n            buttons.push(<ControlButton handler={props[type]} key={index} type={type} size={iconSize} />)\n        }\n        // If game hasn't started and player is host\n        if (player.current.isHost && !gameStarted.current) {\n            buttons.push(<ControlButton handler={props.draw} key={6} type={\"draw\"} size={iconSize} />)\n        }\n\n        setControlButtons(buttons);\n    }, [gameStarted.current, player.current]);\n\n    return (\n        <div className=\"flex items-center justify-center space-x-0 bg-blue-600\">\n            {allowAudio.current ? <Audio /> : null}\n            {controlButtons.current}\n        </div>\n    )\n}\n\nexport default Controls;","import React from 'react';\nimport { countDown } from '../utils';\nimport { ShoppingBag } from 'react-feather';\nimport Modal from './Modal';\nimport { useStateRef } from '../hooks';\n\nconst Bag = ({ bag }) => {\n\n    const [_, setShowContents, showContents] = useStateRef(false);\n\n    return (\n        <div title={`${bag.length} pieces remaining`} onClick={() => setShowContents(!showContents.current)} className=\"flex items-end space-x-0\">\n            <div className=\"flex-none\"><ShoppingBag className=\"cursor-pointer\" fill=\"gray\" size={36} /></div>\n            <div className=\"flex-none cursor-pointer text-gray-500 text-sm\">{countDown(bag.length)}</div>\n            <Modal show={showContents.current} />\n        </div>\n    )\n}\n\nexport default Bag;","import React, { useEffect, useState, useRef, useContext } from 'react';\nimport { SocketIOContext, ValidDragContext, GameContext, NotificationContext } from '../context';\nimport { excludeMeSioEvent, getDragData, inPlaceShuffle, secondsToMMSS } from '../utils';\nimport { useStateRef } from '../hooks';\nimport makeServerRequest from '../xhr';\nimport { Clock } from 'react-feather';\nimport SwapModal from './SwapModal';\nimport Controls from './Controls';\nimport Piece from './Piece';\nimport Bag from './Bag';\nimport { timeoutDelay } from '../constants';\n\n\n\nconst Rack = (props) => {\n\n    const thisRack = useRef();\n    const [pingIntervalID, setPingIntervalID] = useState();\n    const [_c, setTryCount, tryCount] = useStateRef(0);\n    const [_, setPieces, currPieces] = useStateRef([]);\n    const [__, setStartSwap, startSwap] = useStateRef(false);\n    const [__d, setCountDownID, countDownID] = useStateRef(\"\");\n    const [___, setPlayedPieces, currPlayedPieces] = useStateRef([]);\n\n    const sio = useContext(SocketIOContext);\n    const { setValidDrag } = useContext(ValidDragContext);\n    const { notifications, setNotifications } = useContext(NotificationContext);\n    const { player, gameResumed, boardState, rackState, setRackState, setPlayer, bag, setPlayedWords, setPlayFlag, gameStarted, timeToPlay, playedTiles, playedWords, usedTiles, gameEnded, setRecallFlag } = useContext(GameContext);\n    const [_a_, setCountDown, countDown] = useStateRef(timeToPlay.current);\n\n\n    // Get 7 pieces when game starts\n    useEffect(() => {\n        async function getPieces() {\n            if (currPieces.current.length === 0) {\n                setPieces(await getFromBag(7));\n            }\n        }\n\n        // If game is resumed, use set pieces, \n        // else if new game, fetch pieces from server\n        if (rackState.current.length !== 0) {\n            setPieces(rackState.current);\n            setTimeout(() => {\n                sio.emit(\"resumeEvent\", { roomID: player.current.roomID });\n                setRackState([]);\n            }, 1000);\n        }\n        else getPieces();\n    }, []); // [] ensures only on first render\n\n\n    // If game ends, recompute score and announce\n    useEffect(async () => {\n        if (gameEnded.current) {\n            let score = player.current.score;\n\n            // Decrement each piece's weight from score\n            for (const piece of currPieces.current) score -= piece.weight\n\n            let response = await makeServerRequest({\n                requestType: \"post\",\n                url: \"/scores\",\n                payload: {\n                    score: score,\n                    name: player.current.name,\n                    roomID: player.current.roomID,\n                },\n            });\n            if (response.status === \"success\") setPlayer({ ...player.current, turn: false })\n        }\n    }, [gameEnded.current]);\n\n\n    // Effect from Game board\n    useEffect(async () => {\n        if (playedWords.current.length > 0) {\n\n            // Have three chances to play validly\n            // After three, turn is auto skipped\n            if (tryCount.current >= 3) {\n                actualTurnSkip(); // Auto skip turn\n                setTryCount(0); // Reset play chances\n                return;\n            }\n\n            // Get the played words as a list of strings, instead of a list of object strings\n            let playedWordsStr = playedWords.current.map(word => word.map(char => char.char).join(\"\"));\n\n            // Validate the played words from the Scrabble DB\n            let response = await validatePlayedWords(playedWordsStr);\n\n            if (response.status === \"error\") {\n                // Increment play chances\n                setTryCount(tryCount.current + 1);\n\n                setNotifications([{\n                    type: \"error\",\n                    message: response.message,\n                }]);\n            }\n            else {\n                // Determine if bag is already empty when player played\n                let bagIsEmpty = bag.current.length === 0;\n\n                // Determine if rack is empty (all pieces were played)\n                let rackIsEmpty = currPieces.current.length === 0;\n\n                // Compute the score from played words and get the actual played word\n                let playedWord = getPlayedWord(playedWordsStr, currPlayedPieces.current)\n                let score = computeScore(playedWords.current, currPlayedPieces.current.length === 7)\n\n                // Refill rack\n                await refillRack(currPlayedPieces.current.length);\n\n                // Reset played pieces\n                setPlayedPieces([]);\n\n                // Tell everybody\n                sio.emit('playEvent', {\n                    score: score,\n                    word: playedWord,\n                    bagIsEmpty: bagIsEmpty,\n                    rackIsEmpty: rackIsEmpty,\n                    name: player.current.name,\n                    roomID: player.current.roomID,\n                });\n\n                // Remove timer when play happens\n                clearInterval(countDownID.current);\n\n                setPlayedWords([]); // Reset played words\n                setTryCount(0); // Reset play chances\n            }\n        }\n    }, [playedWords.current]);\n\n\n    // Play timer implementation\n    useEffect(() => {\n        // Set the default countdown\n        setCountDown(timeToPlay.current);\n\n        // If there's a count down and it's the player's turn\n        if (timeToPlay.current && player.current.turn) {\n            let intervalID = setInterval(() => {\n                // Countdown and auto skip turn\n                if (countDown.current === 0) actualTurnSkip(); // Skip\n                else setCountDown(countDown.current - 1); // Decrement \n            }, 1000);\n\n            setCountDownID(intervalID); // Store intervalID\n            return () => clearInterval(countDownID.current);\n        }\n    }, [player.current.turn]);\n\n\n    // Get actual played word\n    // Strategy is to weigh each played word by the\n    // pieces played from the rack and choose highest\n    const getPlayedWord = (playedWords, playedPieces) => {\n        let playedWord, wordWeight = 0;\n\n        for (const word of playedWords) {\n            let weight = 0;\n            for (const piece of playedPieces) {\n                if (word.includes(piece.piece)) weight += 1\n            }\n\n            if (weight > wordWeight) {\n                playedWord = word;\n                wordWeight = weight;\n            }\n        }\n        return playedWord;\n    }\n\n\n    // Compute total score of played words\n    const computeScore = (playedWords, isBingo) => {\n\n        let totalScore = 0;\n\n        // For each played word\n        for (const word of playedWords) {\n            // Word score and multiiplier\n            let score = 0, mul = 1;\n\n            // For each character...\n            for (const char of word) {\n                let charWeight = 0;\n                let charTileID = char.tileID;\n                let charTileType = char.tileType;\n\n                // Already cemented tiles? Skip special attrs\n                if (usedTiles.current.includes(charTileID)) {\n                    charWeight = char.weight;\n                }\n                else {\n                    // Update score per tile type\n                    if (charTileType === \"doubleLetter\") {\n                        charWeight = char.weight * 2;\n                    }\n                    else if (charTileType === \"doubleWord\" || charTileType === \"startTile\") {\n                        mul *= 2;\n                        charWeight = char.weight;\n                    }\n                    else if (charTileType === \"tripleWord\") {\n                        mul *= 3;\n                        charWeight = char.weight;\n                    }\n                    else if (charTileType === \"tripleLetter\") {\n                        charWeight = char.weight * 3;\n                    }\n                    // Normal tile\n                    else charWeight = char.weight;\n                }\n\n                score += charWeight; // Score based on weight\n            }\n\n            score *= mul; // Update with multiplier\n\n            // Update total score\n            totalScore += score;\n        }\n\n        // If Bingo, add 50 points\n        totalScore = isBingo ? totalScore + 50 : totalScore;\n\n        return totalScore;\n    }\n\n\n    // Validate words from the server\n    const validatePlayedWords = async (playedWordsStr) => {\n        let response = await makeServerRequest({\n            url: '/validate',\n            requestType: 'post',\n            payload: { words: playedWordsStr },\n        });\n\n        return response;\n    }\n\n\n    // Get passed amount from bag\n    const getFromBag = async (amount) => {\n        let response = await makeServerRequest({\n            payload: {},\n            requestType: 'get',\n            url: `/bag/${amount}?roomID=${player.current.roomID}`,\n        });\n        let returnedPieces = response['pieces'];\n        for (const [index, piece] of Object.entries(returnedPieces)) {\n            piece[\"id\"] = `${index}_${piece.id}`;\n        }\n        return returnedPieces\n    }\n\n    // Refill rack\n    const refillRack = async (amount) => {\n        let pieces = await getFromBag(amount);\n        for (const piece of pieces) addToPieces(piece);\n    }\n\n    // After drag ends, get equivalent piece\n    // on Rack. Done in case of removal\n    const dragEndHandler = (pieceData) => {\n        let playedPiece = findPiece(pieceData, currPieces.current);\n        removePieceFromPieces(playedPiece);\n        addToPlayedPieces(playedPiece);\n    }\n\n    const removePieceFromPieces = (playedPiece) => {\n        let remainingPieces = currPieces.current.filter(piece => piece.id !== playedPiece.id);\n        setPieces([...remainingPieces]);\n    }\n\n    const removePieceFromPlayedPieces = (playedPiece) => {\n        let remainingPieces = [...currPlayedPieces.current].filter(piece => piece.id !== playedPiece.id);\n        setPlayedPieces([...remainingPieces]);\n    }\n\n\n    // Turn off modal\n    const swapCancelHandler = () => setStartSwap(false);\n\n    const getTileRow = (tile) => {\n        tile += 1;\n        return Math.ceil(tile / 15);\n    }\n\n    const getTileColumn = (tile) => {\n        tile += 1;\n        return tile % 15;\n    }\n\n    const getPlayDirection = (playedTiles) => {\n\n        // Sort the tiles in ascending order for use\n        playedTiles = playedTiles.sort((a, b) => a - b);\n\n        let playDirection;\n        let firstTile = playedTiles[0];\n        let firstTileRow = getTileRow(firstTile);\n        const numPlayedTiles = playedTiles.length;\n\n        // If all played tiles are on the same row, then horizontal\n        if (playedTiles.every((t) => getTileRow(t) === firstTileRow)) {\n            playDirection = \"horizontal\";\n        }\n\n        // If not, check if they're all on the same column. If yes, \n        // then it's a vertical play. If not, then it's an invalid play\n        else {\n            for (let i = 0; i < numPlayedTiles; i++) {\n                if ((i + 1) < numPlayedTiles) {\n                    let tt = playedTiles[i]; // this tile\n                    let nt = playedTiles[i + 1]; // next tile\n\n                    // Difference between each\n                    // tile must be fifteen for\n                    // the play to be vertical.\n                    if ((nt - tt) % 15 !== 0) {\n                        playDirection = \"both\";\n                        break;\n                    }\n\n                    playDirection = \"vertical\";\n                }\n            }\n        }\n\n        return playDirection;\n    }\n\n    // If swap is confirmed, get pieces of checked boxes\n    // and remove them from rack. Replace them after and\n    // then disable the swap modal for later reswapping \n    const swapConfirmHandler = async (checkedIDs) => {\n        if (checkedIDs.length > 0) {\n            let piecesSwapped = [];\n\n            // Remove associated ids from rack\n            for (const id of checkedIDs) {\n                let pieceToSwap = findPieceByID(id, currPieces.current);\n                removePieceFromPieces(pieceToSwap);\n                piecesSwapped.push(pieceToSwap);\n            }\n\n            // Remove timer when play happens\n            clearInterval(countDownID.current);\n\n            setStartSwap(false); // Turn off modal\n\n            // Refill rack\n            await refillRack(checkedIDs.length);\n\n            // Announce to everybody\n            sio.emit('playEvent', {\n                piecesSwapped,\n                isTurnSwapped: true,\n                name: player.current.name,\n                roomID: player.current.roomID,\n            });\n        }\n    }\n\n    // Get tiles played on a row or column within the\n    // bounds of the first and last tile the player played\n    const getNeigbouringTiles = (tile, playDirection, playedTiles) => {\n        let tiles = [], allTiles = [];\n        let source = playDirection === \"horizontal\" ? getTileRow(tile) : getTileColumn(tile);\n\n        let loopLength = playDirection === \"horizontal\" ? 1 : 15;\n        let startTile = playDirection === \"horizontal\" ? (source - 1) * 15 : source - 1;\n\n        // Loop fifteen tiles, that is\n        // all tiles in row or column\n        for (let i = 0; i < 15; i++) {\n            // Get played tiles\n            if (playedTiles.includes(startTile)) tiles.push(startTile)\n\n            // Push irregardless\n            allTiles.push(startTile)\n            startTile += loopLength;\n        }\n\n        let first = allTiles.indexOf(tiles[0]);\n        let last = allTiles.indexOf(tiles[tiles.length - 1])\n\n        // Return tile range between \n        // played/cemented tiles\n        return allTiles.slice(first, last + 1);\n    }\n\n\n    // Validate that each played piece is linked\n    // (left, right, top, bottom) to another piece\n    const validateNeighbors = (playedTiles, boardIsEmpty, playDirection) => {\n        let valid = true;\n        let linkCount = 0;\n        let lastTile = playedTiles[playedTiles.length - 1];\n\n        let tiles = getNeigbouringTiles(lastTile, playDirection, playedTiles)\n\n        // Ensure no blanks in between played/cemented tiles\n        // AND logic heirarchy is cemented then played\n        for (const tile of tiles) {\n            if (!usedTiles.current.includes(tile) && !playedTiles.includes(tile)) {\n                valid = false;\n                return valid;\n            }\n        }\n\n        // Ensure played tiles are linked to existing\n        for (const tile of playedTiles) {\n            let linkedTiles = [];\n            let tileUp, tileDown, tileLeft, tileRight;\n\n            tileUp = tile - 15;\n            tileLeft = tile - 1;\n            tileDown = tile + 15;\n            tileRight = tile + 1;\n\n            if (tileUp >= 0) linkedTiles.push(tileUp)\n            if (tileLeft >= 0) linkedTiles.push(tileLeft)\n\n            if (tileDown <= 224) linkedTiles.push(tileDown)\n            if (tileRight <= 224) linkedTiles.push(tileRight)\n\n            // Check all linked tiles\n            linkedTiles.forEach((tileTC) => {\n                // If game has started, at least one tile must be linked to existing tiles\n                if (!boardIsEmpty && usedTiles.current.includes(tileTC)) linkCount += 1;\n            });\n        }\n\n        // Must be linked to at least one existing tile\n        if (!boardIsEmpty && linkCount < 1) valid = false\n\n        return valid\n    }\n\n\n    // Start the play pipeline. Validate neighbors, played words, etc.\n    const initiatePlayPipeline = (playedTiles, boardIsEmpty) => {\n        let playDirection = getPlayDirection(playedTiles);\n        let neighborsAreValid = validateNeighbors(playedTiles, boardIsEmpty, playDirection);\n\n        // Must play in just one direction or weird play move\n        if (playDirection === \"both\" || !neighborsAreValid) {\n            setNotifications([{\n                type: \"error\",\n                message: \"Sorry, that's an invalid move\",\n            }]);\n        }\n        // Switch to gameboard to \n        // validate played words\n        else setPlayFlag(true);\n    }\n\n\n    // Play for turn\n    const play = () => {\n        if (gameEnded.current) {\n            setNotifications([{\n                type: \"info\",\n                message: \"The game has ended. No more actions are possible.\",\n            }]);\n            return;\n        }\n\n        // If it's the player's turn and the game has started\n        if (player.current.turn && (gameStarted.current || gameResumed.current)) {\n\n            // If nothing was played. Warn player...\n            if (currPlayedPieces.current.length === 0) {\n                setNotifications([{\n                    type: \"warning\",\n                    message: \"You haven't played anything. You can alternatively skip your turn\",\n                }]);\n            }\n\n            // If something was played\n            else {\n                let boardIsEmpty = isBoardEmpty();\n\n                // If the board is empty (Game literally just started)\n                if (boardIsEmpty) {\n\n                    // Ensure star tile is played on, on first play\n                    if (!playedTiles.current.includes(112)) {\n                        setNotifications([{\n                            type: \"error\",\n                            message: \"Invalid start move. You must play on the starred tile\",\n                        }]);\n\n                        return; // Exit\n                    }\n                }\n\n                // Star tile was played on. Continue play\n                // Game has been ongoing. Star tile is already used\n                initiatePlayPipeline(playedTiles.current, boardIsEmpty);\n            }\n        }\n    }\n\n\n    // Swap pieces for turn\n    const swap = () => {\n        if (gameEnded.current) {\n            setNotifications([{\n                type: \"info\",\n                message: \"The game has ended. No more actions are possible.\",\n            }]);\n            return;\n        }\n\n        if (player.current.turn && (gameStarted.current || gameResumed.current)) {\n            // Pieces in bag must be more than 7 to swap\n            if (bag.current.length <= 7) {\n                setNotifications([\n                    {\n                        message: `Swapping pieces is no longer possible, as the bag has ${bag.current.length} pieces left. `,\n                        type: \"info\",\n                    }\n                ]);\n            }\n            else {\n                recall();\n                setStartSwap(true);\n            }\n        }\n        else {\n            setNotifications([\n                {\n                    message: `You can not swap pieces until it is your turn to play. Kindly wait your turn`,\n                    overwrite: false,\n                    type: \"warning\",\n                    timeout: 5\n                }\n            ]);\n        }\n\n    }\n\n    // Recall pieces from board\n    const recall = () => {\n\n        if (gameEnded.current) {\n            setNotifications([{\n                type: \"info\",\n                message: \"The game has ended. No more actions are possible.\",\n            }]);\n            return;\n        }\n\n        if (player.current.turn && (gameStarted.current || gameResumed.current)) {\n            // Merge back played pieces to current pieces on rack\n            setPieces([...currPieces.current, ...currPlayedPieces.current]);\n\n            // Reset played pieces\n            setPlayedPieces([]);\n\n            // Signal a recall happened to empty board\n            setRecallFlag(true);\n\n            // Tell everybody\n            sio.emit('recallEvent', {\n                roomID: player.current.roomID,\n                name: player.current.name\n            }\n            );\n        }\n        else {\n            setNotifications([\n                ...notifications.current,\n                {\n                    message: `You can not recall pieces until it's your turn to play. Kindly wait your turn`,\n                    overwrite: false,\n                    type: \"warning\",\n                    timeout: 5\n                }\n            ]);\n        }\n    }\n\n    // Board is empty if there are no cemented tiles\n    const isBoardEmpty = () => usedTiles.current.length === 0;\n\n    // Shuffle pieces on Rack\n    const shuffle = () => setPieces([...inPlaceShuffle(currPieces.current)]);\n\n    // Make draw to determine player turns\n    const draw = () => sio.emit(\"drawEvent\", { roomID: player.current.roomID });\n\n    // Implementation of a turn skip\n    const actualTurnSkip = () => {\n        recall(); // Recall pieces, if any\n\n        // Tell everybody\n        sio.emit('playEvent', {\n            isTurnSkipped: true,\n            name: player.current.name,\n            roomID: player.current.roomID,\n        });\n\n        // Remove timer when play happens\n        clearInterval(countDownID.current);\n    }\n\n    // Skip one's turn\n    const skip = () => {\n        if (gameEnded.current) {\n            setNotifications([{\n                type: \"info\",\n                message: \"The game has ended. No more actions are possible.\",\n            }]);\n            return;\n        }\n\n        if (player.current.turn && (gameStarted.current || gameResumed.current)) {\n            let shouldSkipTurn = window.confirm(\"Are you sure you want to skip your turn?\");\n            if (shouldSkipTurn) actualTurnSkip();\n        }\n        else {\n            setNotifications([\n                ...notifications.current,\n                {\n                    message: `You can not skip turn until it is your turn to play. Kindly wait your turn`,\n                    overwrite: false,\n                    type: \"warning\",\n                    timeout: 5\n                }\n            ]);\n        }\n    }\n\n\n    // Helper functions\n    const addToPieces = (piece) => setPieces([...currPieces.current, piece])\n    const findPieceByID = (pieceID, source) => source.find(piece => piece.id === pieceID);\n    const findPiece = (pieceData, source) => source.find(piece => piece.id === pieceData.id);\n    const addToPlayedPieces = (playedPiece) => setPlayedPieces([...currPlayedPieces.current, playedPiece]);\n\n\n    // Event listeners\n    const handleDragDrop = (e) => {\n        if (player.current.turn) {\n            // Prevent bubble\n            e.preventDefault();\n            e.stopPropagation();\n            e.stopImmediatePropagation();\n\n            // Data of piece dragged on it          \n            const pieceData = getDragData(e);\n\n            // Don't allow drags of cemented tiles\n            if (!usedTiles.current.includes(pieceData.tileID)) {\n                // Get piece dragged back from the ones in rack state\n                let piece = findPiece(pieceData, currPlayedPieces.current);\n\n                // Tell other players\n                sio.emit('inPlayEvent', {\n                    roomID: player.current.roomID,\n                    pieceData: { ...pieceData, toRackMove: true }\n                });\n\n                if (pieceData.onBoard) { // If board-to-rack drag\n                    removePieceFromPlayedPieces(piece);\n                    addToPieces(piece);\n                }\n                else setValidDrag(false); // Rack-to-rack drag. Do nothing.\n            }\n        }\n    }\n\n    // useEffect(() => {\n    //     window.addEventListener('beforeunload', alertUser);\n    //     window.addEventListener('unload', handleGameExit);\n    //     return () => {\n    //         window.removeEventListener('beforeunload', alertUser);\n    //         window.removeEventListener('unload', handleGameExit);\n    //     }\n    // }, []);\n\n    // const alertUser = e => {\n    //     e.preventDefault()\n    //     e.returnValue = ''\n    // }\n\n    // setGamedExited(true);\n\n\n    // const handleGameExit = async () => {\n    //     await saveGame(); // Save the game state\n    //     alert(\"Note that you can still resume this game session using your name and the session ID.\");\n\n    //     setTimeout(() => {\n    //         sio.emit(\"leave\", { roomID: player.current.roomID, name: player.current.name })\n    //     }, 700); \n    // }\n\n\n    // Save rack state in interval (autosave)\n    useEffect(() => {\n        let iID = setInterval(() => {\n            // Save the pieces on the rack\n            if (currPieces.current.length > 0 || currPlayedPieces.current.length > 0) {\n                setRackState([...currPieces.current, ...currPlayedPieces.current]);\n            }\n        }, timeoutDelay);\n\n        setPingIntervalID(iID);\n        return () => clearInterval(pingIntervalID);\n    }, []); // [] Ensures only on first render\n\n\n    // useEffect(async () => {\n    //     if (gameExited.current) {\n    //         await handleGameExit();\n    //         window.location.reload(); // Refresh page (go to home page)                            \n    //     }\n    // }, [gameExited.current]);\n\n\n    const handleDragOver = (e) => e.preventDefault();\n    const handleDragEnter = (e) => e.preventDefault();\n    const handleDragLeave = (e) => e.preventDefault();\n\n    // Effects\n    useEffect(() => thisRack.current.addEventListener(\"drop\", handleDragDrop));\n    useEffect(() => thisRack.current.addEventListener(\"dragover\", handleDragOver));\n    useEffect(() => thisRack.current.addEventListener(\"dragleave\", handleDragLeave));\n    useEffect(() => thisRack.current.addEventListener(\"dragenter\", handleDragEnter));\n\n    const classNames = (gameStarted.current || gameResumed.current) ? \"flex justify-between items-end\" : \"flex justify-end items-end\";\n\n    // Render\n    return (\n        <div className=\"block\">\n            <div ref={thisRack} className=\"flex justify-end\">\n                <div style={{ width: \"25rem\" }} className=\"h-16 flex border-4 bg-gray-300 border-gray-500 rounded-md\">\n                    {currPieces.current ? currPieces.current.map((piece, index) => {\n                        if (piece) return <Piece\n                            id={piece.id}\n                            key={`${piece.id}_${index}`}\n                            onBoard={false}\n                            char={piece.piece}\n                            weight={piece.weight}\n                            dragEndHandler={dragEndHandler}\n                        />\n\n                    }) : null}\n                </div>\n            </div>\n            <div className=\"py-2\"></div>\n            <div className={classNames}>\n\n                {/* Show bag only when game has started */}\n                {gameStarted.current || gameResumed.current ? <Bag bag={bag.current} /> : null}\n\n                <Controls\n                    gameStarted={gameStarted}\n                    shuffle={shuffle}\n                    recall={recall}\n                    skip={skip}\n                    play={play}\n                    draw={draw}\n                    swap={swap}\n                />\n            </div>\n            <div className=\"py-2\"></div>\n            {player.current.turn && timeToPlay.current\n                ?\n                <div title=\"Time left to play\" className={`${countDown.current < 10 ? 'blink' : \"\"} cursor-help flex text-gray-400 justify-end items-center`}>\n                    <Clock size={19} className=\"inline\" />\n                    <span className=\"pl-1\">{secondsToMMSS(countDown.current)}</span>\n                </div>\n                :\n                null}\n\n            <SwapModal\n                show={startSwap.current}\n                pieces={currPieces.current}\n                swapCancelHandler={swapCancelHandler}\n                swapConfirmHandler={swapConfirmHandler}\n            />\n        </div>\n\n    )\n};\n\nexport default Rack;","import React from \"react\";\n\nexport default function GameLogModal({ logs, close, show }) {\n\n    let modal = <>\n        <div onClick={() => close()} className=\"justify-center items-center flex overflow-x-hidden overflow-y-auto fixed inset-0 z-50 outline-none focus:outline-none\">\n            <div className=\"relative w-screen my-6 mx-auto max-w-3xl\">\n                <div className=\"h-96 border-0 rounded-lg shadow-lg relative flex flex-col w-full bg-white outline-none focus:outline-none\">\n                    <div className=\"flex justify-center flex-col pt-7 p-3 border-b border-solid border-blueGray-200 rounded-t\">\n                        <h3 className=\"text-2xl font-semibold\">\n                            Logs\n                        </h3>\n                        <div className=\"text-md pt-1 text-gray-500\">History of in-game plays</div>\n                    </div>\n                    <div className=\"overflow-auto py-0 justify-center\">\n                        {logs.length > 0 ?\n                            <table className=\"table-auto w-full mb-5\">\n                                <thead>\n                                    <tr className=\"bg-gray-100\">\n                                        <th className=\"border border-gray-300 px-4 py-2 text-black-600\">Time</th>\n                                        <th className=\"border border-gray-300 px-4 py-2 text-black-600\">Event</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    {logs.map((log, index) => {\n                                        return <tr key={index}>\n                                            <td className='w-1/5 text-gray-500 capitalize border border-gray-300 px-4 py-2 text-black-600 font-medium'>\n                                                {log.time}\n                                            </td>\n                                            <td className=\"border border-gray-300 px-4 py-2 text-black-600 font-medium\">{log.event}</td>\n                                        </tr>\n                                    })}\n                                </tbody>\n                            </table>\n\n                            : <div className=\"flex pt-28 text-gray-500 justify-center\">Nothing to show :)</div>}\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div className=\"opacity-75 fixed inset-0 z-40 bg-black\"></div>\n    </>\n\n    return (show.current ? modal : null);\n}","import React, { useContext, useEffect } from 'react';\nimport { FileText, Share2, LogOut } from 'react-feather';\nimport { GameContext, SocketIOContext } from '../context';\nimport { useStateRef } from '../hooks';\nimport { excludeMeSioEvent } from '../utils';\nimport makeServerRequest from '../xhr';\n\nimport GameLogModal from './GameLogModal';\n\n\nconst GameLog = (props) => {\n    const sio = useContext(SocketIOContext);\n    const [_, setShowModal, showModal] = useStateRef(false);\n    const [__, setLogs, logs] = useStateRef([]);\n    const { player, rackState, boardState } = useContext(GameContext);\n\n    // Close modal\n    const closeModal = () => setShowModal(false);\n\n    const leaveHandler = async () => {\n        let confirmed = window.confirm(\"Are you sure you want to leave the game?\");\n        if (confirmed) {\n            await saveGame(); // Save the game state\n            alert(\"Note that you can still resume this game session using your name and the session ID.\");\n\n            setTimeout(() => {\n                sio.emit(\"leave\", { roomID: player.current.roomID, name: player.current.name })\n                window.location.reload(); // Refresh page (go to home page)                            \n            }, 700);\n        }\n    }\n\n\n    // Save board and player rack\n    const saveGame = async () => {\n        let payload = {\n            player: player.current,\n            rack: rackState.current,\n            board: boardState.current,\n            roomID: player.current.roomID,\n        }\n\n        await makeServerRequest({ requestType: 'post', url: `/cache`, payload: payload });\n    }\n\n\n    // If game is exited by any player, then let me know\n    // Also save the game first\n    useEffect(() => {\n        const dispatch = async (data) => {\n            await saveGame();\n            alert(`${data.name} has left the game session. Note that you can still resume this game session using your name and the session ID.`);\n            window.location.reload(); // Refresh page (go to home page)                            \n        }\n\n        excludeMeSioEvent(sio, \"leftRoom\", player.current.name, dispatch);\n    }, []);\n\n\n    // Get logs from the server when div is pressed\n    useEffect(async () => {\n        if (showModal.current) {\n            let response = await makeServerRequest({\n                requestType: \"get\",\n                url: `/logs/${player.current.roomID}`,\n            });\n\n            if (response.status === \"success\") setLogs([...response.logs])\n        }\n    }, [showModal.current]);\n\n    return (\n        <>\n            <div className=\"flex justify-between items-center\">\n                <div onClick={() => setShowModal(true)} className=\"cursor-pointer flex justify-end items-end space-x-1 text-gray-500\">\n                    <div className=\"flex-none\">{<FileText size={22} />}</div>\n                    <div className=\"flex-none text-sm\">Game Logs</div>\n                </div>\n                <div className=\"flex justify-end items-end space-x-1\">\n                    <div className=\"font-bold pt-2 text-sm text-gray-500\"><Share2 size={22} className=\"inline pb-1 pr-1\" />{player.current.roomID}\n                    </div>\n                </div>\n                <div onClick={leaveHandler} className=\"flex cursor-pointer justify-end items-end space-x-1\">\n                    <div className=\"font-bold pt-2 text-sm text-red-500\"><LogOut size={22} className=\"inline pb-1 pr-1\" />Leave\n                    </div>\n                </div>\n            </div>\n            <GameLogModal logs={logs.current} close={closeModal} show={showModal} />\n        </>\n    );\n};\n\nexport default GameLog;","import React from 'react';\nimport Connection from './Connection';\nimport ScoreBoard from './ScoreBoard';\nimport Notification from './Notification';\n\nimport Rack from './Rack';\nimport GameLog from './GameLog';\n\nconst GamePanel = (props) => {\n    return (\n        <div className=\"flex flex-col pt-4 pb-10 justify-around w-450\">\n            <div className=\"block\">\n                <Notification />\n            </div>\n            <div className=\"block py-8\">\n                <Connection status=\"off\" />\n            </div>\n            <div className=\"block py-8\">\n                <ScoreBoard />\n            </div>\n            <div className=\"block py-8\">\n                <div className=\"flex justify-end\">\n                    <Rack />\n                </div>\n            </div>\n            <div className=\"block\">\n                <div className=\"pt-1\">\n                    <GameLog />\n                </div>\n            </div>\n        </div>\n    )\n};\n\nexport default GamePanel;","import React from 'react';\nimport { Plus, ChevronsRight, CornerUpRight } from 'react-feather';\n\nconst GameChooser = (props) => {\n\n    return (\n        <div className=\"h-full w-full flex flex-col items-center justify-center\">\n            <div className=\"block flex justify-center text-gray-800 text-bold text-3xl space-x-2\">\n                <div className=\"text-4xl\">\n                    Scrabble\n                </div>\n                <div className=\"bg-yellow-200 px-2 font-normal rounded-md text-black self-center text-sm border\">\n                    v2.4\n                </div>\n            </div>\n            <div className=\"flex my-6 mb-2 space-x-6 block justify-center\">\n                <button title=\"Create a new game session\" onClick={() => props.setGameChoice(\"new\")} className=\"h-12 w-36 bg-green-600 hover:bg-green-700 text-white font-bold px-4 border border-green-700 rounded inline-flex justify-center items-center\">\n                    <Plus strokeWidth={3} size={26} />\n                    <span className=\"pl-1 pr-2 text-md\">Host</span>\n                </button>\n                <button onClick={() => props.setGameChoice(\"join\")} className=\"h-12 w-36 bg-blue-600 hover:bg-blue-700 text-white font-bold px-4 border border-blue-700 rounded inline-flex justify-center items-center\">\n                    <ChevronsRight strokeWidth={3} size={26} />\n                    <span title=\"Join a game session\"  className=\"pl-1 pr-2 text-md\">Join</span>\n                </button>\n                <button onClick={() => props.setGameChoice(\"resume\")} className=\"h-12 w-36 bg-red-600 hover:bg-red-700 text-white font-bold px-4 border border-red-700 rounded inline-flex justify-center items-center\">\n                    <CornerUpRight strokeWidth={3} size={22} />\n                    <span title=\"Resume a game session\"  className=\"pl-1 pr-1 text-md\">Resume</span>\n                </button>\n            </div>\n            <div className=\"flex my-4 mb-2 space-x-6 block justify-center\">\n                <div className=\"text-gray-400\">Familiarize yourself with the <a className=\"text-blue-500\" href=\"https://github.com/olumidesan/scrabble\" target=\"_blank\" referrerPolicy=\"no-referrer\">Game Notes</a> before you begin</div>\n            </div>\n        </div>\n    )\n};\n\nexport default GameChooser;","import React, { useEffect, useContext } from 'react';\nimport { Trash2, Users, Share2 } from 'react-feather';\nimport { GameContext, NotificationContext, SocketIOContext } from '../context';\nimport { useStateRef } from '../hooks';\nimport { countUp } from '../utils';\n\n\nconst WaitingRoom = (props) => {\n    const sio = useContext(SocketIOContext);\n    const { setNotifications } = useContext(NotificationContext);\n    const [_, setConnectedPlayers, connectedPlayers] = useStateRef([]);\n    const [_s, setPrepText, prepText] = useStateRef(\"Preparing game room...\");\n    const { player, setRackState, setGameResumed, setGameCreated, setAllowAudio, setPlayers, setUsedTiles, setTimeToPlay } = useContext(GameContext);\n\n\n    useEffect(() => {\n        // Set self as connected. ??? Network issue\n        setConnectedPlayers([player.current]);\n\n        // Register socket io listeners\n        sio.on(\"joinedRoom\", (data) => {\n\n            // Set up audio chat and timer\n            setTimeToPlay(data.timeToPlay);\n            setAllowAudio(data.enableAudio);\n\n            // Overwrite my list of connected players\n            // with what the server sent, as it's updated\n            setConnectedPlayers(data.connectedPlayers);\n\n            // If it's not my connection event\n            // if (data.player.name !== player.current.name) {\n                // Game should start if the required number of players is reached and I'm the host\n                if (connectedPlayers.current.length === props.numPlayers && player.current.isHost) {\n                    sio.emit(data.mode === 'create' ? \"gameCreateEvent\" : \"gameResumeEvent\", { roomID: props.roomID });\n                }\n            // }\n        });\n\n\n        // When game is created, overwrite \n        // players with what host sent\n        // and signal that game has started\n        sio.on(\"gameCreate\", (data) => {\n\n            let welcomeMessage = player.current.isHost\n                ? \"Make a draw using the yellow button on your button rack. You'll\"\n                : \"The host will make a draw, and you'll\";\n\n            setNotifications([\n                {\n                    message: `Welcome, ${player.current.name}! ${welcomeMessage} be notified (just like this) of who gets to play first. Good luck! `,\n                    overwrite: false,\n                    type: \"info\",\n                }\n            ]);\n\n            setPlayers(data.allPlayers);\n\n            // Dilly-dally for effect\n            setTimeout(() => {\n                setPrepText(\"Fetching game bag...\")\n            }, 1500);\n\n            setTimeout(() => {\n                setGameCreated(true);\n            }, 3500);\n\n        }, []);\n\n        // When game is resumed, overwrite \n        // players with what host sent\n        // and signal that game has started\n        sio.on(\"gameResume\", (data) => {\n\n            setNotifications([\n                {\n                    message: `Welcome back, ${player.current.name}. Again, Good luck! `,\n                    overwrite: false,\n                    type: \"info\",\n                }\n            ]);\n\n            setPlayers(data.allPlayers);\n\n            // Replace already played tiles on board\n            setUsedTiles(data.usedTiles);\n\n            // Replace rack\n            setRackState(data.rack[player.current.name])\n\n            // Dilly-dally for effect\n            setTimeout(() => {\n                setPrepText(\"Fetching your pieces...\")\n            }, 1500);\n\n            // Dilly-dally for effect\n            setTimeout(() => {\n                setPrepText(\"Resuming board state...\")\n            }, 3500);\n\n            setTimeout(() => {\n                setGameResumed(true);\n            }, 5500);\n\n        }, []);\n    }, []);\n\n\n    return (\n        <div className=\"h-full w-full flex flex-col items-center justify-center\">\n            <div className=\"max-w-sm pt-4 w-96 rounded overflow-hidden shadow-2xl\">\n                <div className=\"px-8 flex justify-between items-center w-full py-4\">\n\n                    <div className=\"font-bold text-left text-2xl\">Waiting Room\n                    </div>\n                    <div title=\"Share this ID with players you want to join your game session\" className=\"cursor-help font-bold pt-2 text-sm text-gray-400\"><Share2 size={23} className=\"inline pb-1 pr-1\" />{props.roomID}\n                    </div>\n\n                </div>\n                <div className=\"py-8 px-6 border-t border\">\n                    <Users size={22} className=\"inline\" /> Connected players: {countUp(connectedPlayers.current.length)}/<span className=\"font-bold\">{props.numPlayers}</span>\n                </div>\n                {connectedPlayers.current.length === props.numPlayers\n                    ?\n                    <div className=\"py-4 border-t border\">\n                        <div className=\"text-sm italic text-gray-500\">{prepText.current}</div>\n                    </div>\n                    :\n                    null}\n                <div className=\"py-4 border-t border\">\n                    {connectedPlayers.current.map((p, index) => {\n                        return <div key={index} className=\"text-sm text-gray-500\">{p.name === player.current.name ? `You (${p.name})` : p.name} joined the game room</div>\n                    })\n                    }\n                </div>\n                {player.current.isHost\n                    ?\n                    <div className=\"h-14 border-t border\">\n                        <button onClick={props.handleDestroyGameSession} className=\"h-full w-full bg-red-600 hover:bg-red-700 text-white font-bold border border-red-700 inline-flex justify-center items-center\">\n                            <Trash2 size={22} />\n                            <span className=\"pl-1 pr-2 text-md\">Delete Session</span>\n                        </button>\n                    </div>\n                    :\n                    null\n                }\n            </div>\n        </div>\n    )\n};\n\nexport default WaitingRoom;","import React, { useContext, useState } from 'react';\nimport { CornerUpRight, X } from 'react-feather';\nimport WaitingRoom from './WaitingRoom';\nimport makeServerRequest from '../xhr';\nimport { GameContext, SocketIOContext } from '../context';\nimport { isAlphanumeric } from '../utils';\n\nconst ResumeGame = (props) => {\n    const [numPlayers, setNumPlayers] = useState(0);\n    const [gameResumed, setGameResumed] = useState(false);\n    const [sessionID, setSessionID] = useState({ valid: true, message: \"\", roomID: \"\" });\n    const [sessionName, setSessionName] = useState({ valid: true, message: \"\", name: \"\" });\n\n    const sio = useContext(SocketIOContext);\n    const { setPlayer } = useContext(GameContext);\n\n\n    const handleNameChange = (e) => {\n        setSessionName({ ...sessionName, valid: true, name: e.target.value.trim() });\n    }\n\n    const handleRoomIDChange = (e) => {\n        setSessionID({ ...sessionID, valid: true, roomID: e.target.value.trim() });\n    }\n\n    const getGameRoomData = async (gameRoomID, mode) => await makeServerRequest({ requestType: 'get', url: `/room/${gameRoomID}?name=${sessionName.name}&mode=${mode}`, payload: {} });\n\n    const handleResumeGameSession = async () => {\n\n        // Validate length\n        if (sessionName.name.length < 2 || sessionName.name.length > 10) {\n            setSessionName({ ...sessionName, valid: false, message: \"Name must be between 2 and 10 characters\" });\n            return;\n        }\n\n        // Validate alphanumerism\n        if (!isAlphanumeric(sessionName.name)) {\n            setSessionName({ ...sessionName, valid: false, message: \"Name must be alphanumeric\" });\n            return;\n        }\n\n        // Validate game room length\n        if (sessionID.roomID.length < 11) {\n            setSessionID({ ...sessionID, valid: false, message: \"Session ID must be 11 characters\" });\n            return;\n        }\n\n        const gameRoomData = await getGameRoomData(sessionID.roomID, 'resume');\n\n        // If no game is created with that room/session ID\n        if (gameRoomData.status === \"error\") {\n            setSessionID({ ...sessionID, valid: false, message: gameRoomData.message });\n        }\n        // If no such name existed in game session\n        else if (gameRoomData.status === \"nameError\") {\n            setSessionName({ ...sessionName, valid: false, message: gameRoomData.message });\n        }\n\n        else {\n            const currentPlayer = {\n                turn: false, // Leave turn initially\n                isSpeaking: false,\n                roomID: sessionID.roomID,\n                score: gameRoomData.player.score,\n                isHost: gameRoomData.player.isHost,\n                name: sessionName.name.capitalize(),\n            };\n\n            sio.emit(\"resume\", { roomID: sessionID.roomID, player: currentPlayer });\n            setNumPlayers(gameRoomData.limit);\n            setPlayer(currentPlayer);\n            setGameResumed(true);\n        }\n    }\n\n    let classNames = `${sessionName.valid ? \"mb-4\" : \"mb-0\"} w-80 appearance-none block bg-gray-100 text-gray-700 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500`\n\n    return (\n        gameResumed\n            ?\n            <WaitingRoom roomID={sessionID.roomID} numPlayers={numPlayers} />\n            :\n            <div className=\"h-full w-full flex flex-col items-center justify-center\">\n                <div className=\"font-medium text-xl pb-3\">Resume a Game Session</div>\n\n                <div className=\"justify-center flex flex-col pt-4 w-96 rounded overflow-hidden shadow-2xl\">\n                    <div className=\"flex self-center pt-6 mx-3 mb-1\">\n                        <div className=\"px-3\">\n                            <label className=\"block uppercase text-left tracking-wide text-gray-700 text-xs font-bold mb-1\">\n                                Your Name\n                            </label>\n                            <input minLength={3} maxLength={10} onChange={handleNameChange} title=\"Your name\" className={classNames} type=\"text\" placeholder=\"E.g. Joey\" />\n                        </div>\n                    </div>\n                    <div className=\"flex self-center wrap mx-3\">\n                        {!sessionName.valid\n                            ?\n                            <div className=\"w-full px-3\">\n                                <div className=\"w-80 md:flex md:items-center\">\n                                    <span className=\"text-sm text-red-600 mb-4\">\n                                        {sessionName.message}\n                                    </span>\n                                </div>\n                            </div>\n                            :\n                            null\n                        }\n                    </div>\n                    <div className=\"flex self-center mx-3 mb-0\">\n                        <div className=\"px-3\">\n                            <label className=\"block uppercase text-left tracking-wide text-gray-700 text-xs font-bold mb-2\">\n                                Session ID\n                            </label>\n                            <input onChange={handleRoomIDChange} maxLength={11} className=\"w-80 appearance-none block bg-gray-100 text-gray-700 border border-gray-200 rounded py-3 px-4 mb-1 leading-tight focus:outline-none focus:bg-white focus:border-gray-500\" type=\"text\" placeholder=\"E.g. 41828-11860\" />\n                        </div>\n                    </div>\n                    <div className=\"flex self-center wrap mx-3 mb-6\">\n                        {!sessionID.valid\n                            ?\n                            <div className=\"w-full px-3\">\n                                <div className=\"w-80  md:flex md:items-center\">\n                                    <span className=\"text-sm text-red-600 pb-2\">\n                                        {sessionID.message}\n                                    </span>\n                                </div>\n                            </div>\n                            :\n                            null\n                        }\n                    </div>\n                    <div className=\"h-14 border-t flex border\">\n                        <div className=\"block w-1/2\">\n                            <button onClick={() => props.setGameChoice(\"cancel\")} className=\"h-full w-full bg-red-600 hover:bg-red-700 text-white font-bold border border-red-700 inline-flex justify-center items-center\">\n                                <X size={26} />\n                                <span className=\"pl-1 pr-2 text-md\">Cancel</span>\n                            </button>\n                        </div>\n                        <div className=\"block w-1/2\">\n                            <button onClick={handleResumeGameSession} className=\"h-full w-full bg-green-600 hover:bg-green-700 text-white font-bold border border-green-700 inline-flex justify-center items-center\">\n                                <CornerUpRight className=\"pb\" strokeWidth={3} size={26} />\n                                <span className=\"pl-1 pr-2 text-md\">Resume</span>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n    )\n};\n\nexport default ResumeGame;","import React, { useContext, useState } from 'react';\nimport { ChevronsRight, X } from 'react-feather';\nimport WaitingRoom from './WaitingRoom';\nimport makeServerRequest from '../xhr';\nimport { GameContext, SocketIOContext } from '../context';\nimport { isAlphanumeric } from '../utils';\n\nconst JoinGame = (props) => {\n\n    const [numPlayers, setNumPlayers] = useState(0);\n    const [gameJoined, setGameJoined] = useState(false);\n    const [sessionID, setSessionID] = useState({ valid: true, message: \"\", roomID: \"\" });\n    const [sessionName, setSessionName] = useState({ valid: true, message: \"\", name: \"\" });\n\n    const sio = useContext(SocketIOContext);\n    const { setPlayer } = useContext(GameContext);\n\n\n    const handleNameChange = (e) => {\n        setSessionName({ ...sessionName, valid: true, name: e.target.value.trim() });\n    }\n\n    const handleRoomIDChange = (e) => {\n        setSessionID({ ...sessionID, valid: true, roomID: e.target.value.trim() });\n    }\n\n    const getGameRoomData = async (gameRoomID, mode) => await makeServerRequest({ requestType: 'get', url: `/room/${gameRoomID}?name=${sessionName.name}&mode=${mode}`, payload: {} });\n\n    const handleJoinGameSession = async () => {\n\n        // Validate length\n        if (sessionName.name.length < 2 || sessionName.name.length > 10) {\n            setSessionName({ ...sessionName, valid: false, message: \"Name must be between 2 and 10 characters\" });\n            return;\n        }\n\n        // Validate alphanumerism\n        if (!isAlphanumeric(sessionName.name)) {\n            setSessionName({ ...sessionName, valid: false, message: \"Name must be alphanumeric\" });\n            return;\n        }\n\n        // Validate game room length\n        if (sessionID.roomID.length < 11) {\n            setSessionID({ ...sessionID, valid: false, message: \"Session ID must be 11 characters\" });\n            return;\n        }\n\n        const gameRoomData = await getGameRoomData(sessionID.roomID, 'join');\n\n        // If no game is created with that room/session ID\n        if (gameRoomData.status === \"error\") {\n            setSessionID({ ...sessionID, valid: false, message: gameRoomData.message });\n        }\n        // If chosen name is already being used\n        else if (gameRoomData.status === \"nameError\") {\n            setSessionName({ ...sessionName, valid: false, message: gameRoomData.message });\n        }\n\n        else {\n            if (gameRoomData.room.joinable) {\n                const currentPlayer = {\n                    score: 0,\n                    turn: false,\n                    isHost: false,\n                    isSpeaking: false,\n                    roomID: sessionID.roomID,\n                    name: sessionName.name.capitalize(),\n                };\n\n                sio.emit(\"join\", { roomID: sessionID.roomID, player: currentPlayer });\n                setNumPlayers(gameRoomData.room.limit);\n                setPlayer(currentPlayer);\n                setGameJoined(true);\n            }\n            else {\n                setSessionID({ valid: false, message: \"Game session has started and cannot be joined\" });\n            }\n        }\n    }\n\n    let classNames = `${sessionName.valid ? \"mb-4\" : \"mb-0\"} w-80 appearance-none block bg-gray-100 text-gray-700 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500`\n\n    return (\n        gameJoined\n            ?\n            <WaitingRoom roomID={sessionID.roomID} numPlayers={numPlayers} />\n            :\n            <div className=\"h-full w-full flex flex-col items-center justify-center\">\n                <div className=\"font-medium text-xl pb-3\">Join a Game Session</div>\n\n                <div className=\"justify-center flex flex-col pt-4 w-96 rounded overflow-hidden shadow-2xl\">\n                    <div className=\"flex self-center pt-6 mx-3 mb-1\">\n                        <div className=\"px-3\">\n                            <label className=\"block uppercase text-left tracking-wide text-gray-700 text-xs font-bold mb-1\">\n                                Your Name\n                            </label>\n                            <input minLength={3} maxLength={10} onChange={handleNameChange} title=\"Your name\" className={classNames} type=\"text\" placeholder=\"E.g. Joey\" />\n                        </div>\n                    </div>\n                    <div className=\"flex self-center wrap mx-3\">\n                        {!sessionName.valid\n                            ?\n                            <div className=\"w-full px-3\">\n                                <div className=\"w-80 md:flex md:items-center\">\n                                    <span className=\"text-sm text-red-600 mb-4\">\n                                        {sessionName.message}\n                                    </span>\n                                </div>\n                            </div>\n                            :\n                            null\n                        }\n                    </div>\n                    <div className=\"flex self-center mx-3 mb-0\">\n                        <div className=\"px-3\">\n                            <label className=\"block uppercase text-left tracking-wide text-gray-700 text-xs font-bold mb-2\">\n                                Session ID\n                            </label>\n                            <input onChange={handleRoomIDChange} maxLength={11} className=\"w-80 appearance-none block bg-gray-100 text-gray-700 border border-gray-200 rounded py-3 px-4 mb-1 leading-tight focus:outline-none focus:bg-white focus:border-gray-500\" type=\"text\" placeholder=\"E.g. 41828-11860\" />\n                        </div>\n                    </div>\n                    <div className=\"flex self-center wrap mx-3 mb-6\">\n                        {!sessionID.valid\n                            ?\n                            <div className=\"w-full px-3\">\n                                <div className=\"w-80  md:flex md:items-center\">\n                                    <span className=\"text-sm text-red-600 pb-2\">\n                                        {sessionID.message}\n                                    </span>\n                                </div>\n                            </div>\n                            :\n                            null\n                        }\n                    </div>\n                    <div className=\"h-14 border-t flex border\">\n                        <div className=\"block w-1/2\">\n                            <button onClick={() => props.setGameChoice(\"cancel\")} className=\"h-full w-full bg-red-600 hover:bg-red-700 text-white font-bold border border-red-700 inline-flex justify-center items-center\">\n                                <X size={26} />\n                                <span className=\"pl-1 pr-2 text-md\">Cancel</span>\n                            </button>\n                        </div>\n                        <div className=\"block w-1/2\">\n                            <button onClick={handleJoinGameSession} className=\"h-full w-full bg-green-600 hover:bg-green-700 text-white font-bold border border-green-700 inline-flex justify-center items-center\">\n                                <ChevronsRight className=\"pb\" strokeWidth={3} size={26} />\n                                <span className=\"pl-1 pr-2 text-md\">Join</span>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n    )\n};\n\nexport default JoinGame;","import React, { useContext, useState } from 'react';\nimport { Plus, ChevronDown, X, AlertOctagon } from 'react-feather';\nimport { GameContext, SocketIOContext } from '../context';\nimport { generateRandomID, isAlphanumeric } from '../utils';\nimport WaitingRoom from './WaitingRoom';\n\n\n// Create a random room ID initially\nlet roomID = `${generateRandomID(5)}-${generateRandomID(5)}`;\n\nconst NewGame = (props) => {\n\n    const [numPlayers, setNumPlayers] = useState(2);\n    const [timeToPlay, setTimeToPlay] = useState(null);\n    const [gameCreated, setGameCreated] = useState(false);\n    const [enableAudio, setEnableAudio] = useState(false);\n    const [sessionName, setSessionName] = useState({ valid: true, message: \"\", name: \"\" });\n\n    const sio = useContext(SocketIOContext);\n    const { setPlayer } = useContext(GameContext);\n\n    const handleNameChange = (e) => {\n        setSessionName({ ...sessionName, valid: true, name: e.target.value.trim() });\n    }\n\n    const handleNumPlayersChange = (e) => {\n        setNumPlayers(parseInt(e.target.value))\n    }\n\n    const handleTimeToPlayChange = (e) => {\n        if (e.target.value !== \"Disabled\") setTimeToPlay(parseInt(e.target.value))\n        else setTimeToPlay(null)\n    }\n\n    const handleEnableAudioChange = (e) => {\n        setEnableAudio(e.target.checked)\n    }\n\n    const handleDestroyGameSession = () => {\n        if (window.confirm(\"Are you sure you want to delete this game session?\")) {\n            setNumPlayers(2);\n            setEnableAudio(false);\n            setGameCreated(false);\n            props.setGameChoice(\"cancel\");\n            setSessionName({ message: \"\", valid: true, name: \"\" });\n\n            // Remove the room from server\n            sio.emit(\"leave\", { roomID });\n\n            // If room is killed, regenerate ID\n            roomID = `${generateRandomID(5)}-${generateRandomID(5)}`;\n        }\n    }\n\n    const handleCreateGameSession = () => {\n        // Validate length\n        if (sessionName.name.length < 2 || sessionName.name.length > 10) {\n            setSessionName({ ...sessionName, valid: false, message: \"Name must be between 2 and 10 characters\" });\n            return;\n        }\n\n        // Validate alphanumerism\n        if (!isAlphanumeric(sessionName.name)) {\n            setSessionName({ ...sessionName, valid: false, message: \"Name must be alphanumeric\" });\n            return;\n        }\n\n        let currentPlayer = {\n            roomID,\n            score: 0,\n            turn: false,\n            isHost: true,\n            isSpeaking: false,\n            name: sessionName.name.capitalize(),\n        };\n\n        sio.emit(\"join\", { roomID, enableAudio, timeToPlay, player: currentPlayer, limit: numPlayers });\n        setPlayer(currentPlayer);\n        setGameCreated(true);\n    }\n\n    let classNames = `${sessionName.valid ? \"mb-4\" : \"mb-0\"} w-80 appearance-none block bg-gray-100 text-gray-700 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-gray-500`;\n\n    return (\n        gameCreated\n            ?\n            <WaitingRoom\n                roomID={roomID}\n                numPlayers={numPlayers}\n                handleDestroyGameSession={handleDestroyGameSession}\n            />\n            :\n            <div className=\"h-full w-full flex flex-col items-center justify-center\">\n                <div className=\"font-medium text-xl pb-3\">Host a Game Session</div>\n\n                <div className=\"justify-center flex flex-col pt-4 w-96 rounded overflow-hidden shadow-2xl\">\n                    <div className=\"flex self-center pt-6 mx-3 mb-2\">\n                        <div className=\"px-3\">\n                            <label className=\"block uppercase text-left tracking-wide text-gray-700 text-xs font-bold mb-2\">\n                                Your Session ID\n                            </label>\n                            <input title=\"Automatically-generated session ID\" disabled value={roomID} className=\"w-80 cursor-not-allowed appearance-none block bg-gray-100 text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight focus:outline-none focus:bg-white focus:border-gray-500\" type=\"text\" placeholder=\"E.g. Joey\" />\n                        </div>\n                    </div>\n                    <div className=\"flex self-center mx-3 mb-1\">\n                        <div className=\"px-3\">\n                            <label className=\"block uppercase text-left tracking-wide text-gray-700 text-xs font-bold mb-1\">\n                                Your Name\n                            </label>\n                            <input minLength={3} maxLength={10} onChange={handleNameChange} title=\"Your name\" className={classNames} type=\"text\" placeholder=\"E.g. Phoebe\" />\n                        </div>\n                    </div>\n                    <div className=\"flex self-center wrap mx-3\">\n                        {!sessionName.valid\n                            ?\n                            <div className=\"w-full px-3\">\n                                <div className=\"w-80 md:flex md:items-center\">\n                                    <span className=\"text-sm text-red-600 mb-4\">\n                                        {sessionName.message}\n                                    </span>\n                                </div>\n                            </div>\n                            :\n                            null\n                        }\n                    </div>\n                    <div className=\"flex self-center flex-wrap -mx-3 mt-1 mb-4\">\n                        <div className=\"w-full px-3\">\n                            <label className=\"block uppercase text-left tracking-wide text-gray-700 text-xs font-bold mb-2\">\n                                Number of Players\n                            </label>\n                            <div className=\"relative\">\n                                <select onChange={handleNumPlayersChange} className=\"block cursor-pointer appearance-none w-80 bg-gray-100 border border-gray-200 text-gray-700 py-3 px-4 pr-8 rounded leading-tight focus:outline-none focus:bg-white focus:border-gray-500\">\n                                    <option defaultValue value={2}>Two</option>\n                                    <option value={3}>Three</option>\n                                    <option value={4}>Four</option>\n                                </select>\n                                <div className=\"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700\">\n                                    <ChevronDown size={20} />\n                                </div>\n                            </div>\n\n                        </div>\n                    </div>\n                    <div className=\"flex self-center flex-wrap -mx-3 mt-1 mb-6\">\n                        <div className=\"w-full px-3\">\n                            <label title=\"Required time to play before turn is automatically skipped\" className=\"cursor-help block uppercase text-left tracking-wide text-gray-700 text-xs font-bold mb-2\">\n                                Time to Play\n                            </label>\n                            <div className=\"relative\">\n                                <select onChange={handleTimeToPlayChange} className=\"block cursor-pointer appearance-none w-80 bg-gray-100 border border-gray-200 text-gray-700 py-3 px-4 pr-8 rounded leading-tight focus:outline-none focus:bg-white focus:border-gray-500\">\n                                    <option defaultValue value={null}>Disabled</option>\n                                    <option value={300}>Five minutes</option>\n                                    <option value={240}>Four minutes</option>\n                                    <option value={180}>Three minutes</option>\n                                    <option value={120}>Two minutes</option>\n                                    <option value={60}>One minute</option>\n                                </select>\n                                <div className=\"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700\">\n                                    <ChevronDown size={20} />\n                                </div>\n                            </div>\n\n                        </div>\n                    </div>\n                    {/* Audio chat is only available locally or when deployed on an SSL-enabled server */}\n                    {window.location.protocol === 'https' || window.location.hostname === 'localhost'\n                        ?\n                        <div className=\"flex self-center wrap mx-3 mb-4\">\n                            <div className=\"w-full px-3\">\n                                <div title=\"If checked, push-to-talk audio between players will be allowed. That is, of course, if the player allows it\" className=\"w-80 cursor-help md:flex md:items-center mb-2\">\n                                    <label className=\"pb-1 block text-gray-500 font-bold\">\n                                        <input onChange={handleEnableAudioChange} className=\"mr-2 leading-tight h-5 w-5\" type=\"checkbox\" />\n                                    </label>\n                                    <span className=\"text-sm pb-2\">\n                                        Enable Audio Chat (Push-To-Talk)\n                                    </span>\n                                </div>\n                            </div>\n                        </div>\n                        :\n                        null\n                    }\n                    <div className=\"h-14 border-t flex border\">\n                        <div className=\"block w-1/2\">\n                            <button onClick={() => props.setGameChoice(\"cancel\")} className=\"h-full w-full bg-red-600 hover:bg-red-700 text-white font-bold border border-red-700 inline-flex justify-center items-center\">\n                                <X size={26} />\n                                <span className=\"pl-1 pr-2 text-md\">Cancel</span>\n                            </button>\n                        </div>\n                        <div className=\"block w-1/2\">\n                            <button onClick={handleCreateGameSession} className=\"h-full w-full bg-green-600 hover:bg-green-700 text-white font-bold border border-green-700 inline-flex justify-center items-center\">\n                                <Plus className=\"pb\" strokeWidth={3} size={26} />\n                                <span className=\"pl-1 pr-2 text-md\">Host</span>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n    )\n};\n\nexport default NewGame;","import React, { useState, useEffect } from 'react';\nimport GameChooser from './GameChooser';\nimport ResumeGame from './ResumeGame';\nimport JoinGame from './JoinGame';\nimport NewGame from './NewGame';\n\nconst LandingPage = (props) => {\n\n    // State\n    const [newGame, setNewGame] = useState(false);\n    const [joinGame, setJoinGame] = useState(false);\n    const [resumeGame, setResumeGame] = useState(false);\n\n    const setGameChoice = (choice) => {\n        if (choice === \"new\") {\n            setNewGame(true);\n            setJoinGame(false);\n            setResumeGame(false);\n        }\n        else if (choice === \"join\") {\n            setJoinGame(true);\n            setNewGame(false);\n            setResumeGame(false);\n        }\n        else if (choice === \"resume\") {\n            setNewGame(false);\n            setJoinGame(false);\n            setResumeGame(true);\n        }\n        else {\n            setNewGame(false);\n            setJoinGame(false);\n            setResumeGame(false);\n        }\n    }\n\n\n    let page;\n\n    if (newGame) {\n        page = <NewGame setGameChoice={setGameChoice} />\n    }\n    else if (joinGame) {\n        page = <JoinGame setGameChoice={setGameChoice} />\n    }\n    else if (resumeGame) {\n        page = <ResumeGame setGameChoice={setGameChoice} />\n    }\n    else {\n        page = <GameChooser setGameChoice={setGameChoice} />;\n    }\n\n    return page;\n};\n\nexport default LandingPage;","import React, { useContext, useEffect, useState } from \"react\";\nimport { SocketIOContext } from \"../context\";\nimport { GameContext } from \"../context\";\nimport { ThumbsUp } from \"react-feather\";\nimport { useStateRef } from \"../hooks\";\n\nexport default function WinnerModal(props) {\n    const [_, setShow, show] = useStateRef(false);\n    const [endMessage, setEndMessage] = useState(\"\");\n\n    const sio = useContext(SocketIOContext);\n    const { player, setPlayers } = useContext(GameContext);\n\n    useEffect(() => {\n        // When the game ends. Show a modal with the winner\n        sio.on(\"gameEnd\", (data) => {\n            let finalMessage;\n            let winner = { name: \"\", score: 0 };\n\n            // Compare scores to get winner\n            for (const p of data) {\n                if (p.score > winner.score) {\n                    winner.name = p.name;\n                    winner.score = p.score;\n                }\n            }\n\n            // Construct final message\n            if (player.current.name === winner.name) {\n                finalMessage = `Congratulations, ${winner.name}! You are the winner with ${winner.score} points. You've earned the trophy!`;\n            } else {\n                finalMessage = `${winner.name} is the winner with ${winner.score} points. Good game, ${player.current.name}. You still earn a medal `;\n            }\n\n            // Update medals on score board\n            for (const p of data) {\n                if (p.name === winner.name) {\n                    p.name = `${p.name} `;\n                }\n                else p.name = `${p.name} `;\n            }\n\n            setEndMessage(finalMessage);\n            setPlayers(data);\n            setShow(true);\n        });\n    }, []);\n\n\n    let modal = <>\n        <div className=\"justify-center items-center flex overflow-x-hidden overflow-y-auto fixed inset-0 z-50 outline-none focus:outline-none\">\n            <div className=\"relative w-screen my-6 mx-auto max-w-3xl\">\n                <div className=\"border-0 rounded-lg shadow-lg relative flex flex-col w-full bg-white outline-none focus:outline-none\">\n                    <div className=\"flex justify-center flex-col pt-7 p-3 border-b border-solid border-blueGray-200 rounded-t\">\n                        <h3 className=\"text-2xl font-semibold\">\n                             The Game Has Ended \n                        </h3>\n                    </div>\n                    <div className=\"flex-col relative text-lg pt-5 pb-7 flex justify-center flex-wrap\">\n                        <div className=\"pb-6\">{endMessage}</div>\n                        <button onClick={() => { setShow(false) }} className=\"self-center bg-green-600 hover:bg-green-700 text-white inline py-2 px-4 border border-green-700 rounded\">\n                            <ThumbsUp className=\"inline pb-1\" strokeWidth={2} size={24} />\n                            <span className=\"pl-1\">Cool, Thanks</span>\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div className=\"opacity-75 fixed inset-0 z-40 bg-black\"></div>\n    </>\n\n    return (show.current ? modal : null);\n}","import React, { useEffect, useContext } from 'react';\nimport GameBoard from '../components/GameBoard';\nimport GamePanel from '../components/GamePanel';\nimport { useStateRef } from '../hooks';\nimport { ValidDragContext, GameContext, SocketIOContext, NotificationContext } from '../context';\nimport LandingPage from '../components/LandingPage';\nimport WinnerModal from '../components/WinnerModal';\n\n\n// [TODO] Definitely need to revamp this\n\n// Game has two played pieces store\n// The rack's own for its own use,\n// and the Game's own for use with\n// the board for clearing or comm.\nconst Game = () => {\n\n    const [e________, setGameEnded, gameEnded] = useStateRef(false);\n    const [g_______, setGameCreated, gameCreated] = useStateRef(false);\n    const [r_______, setGameResumed, gameResumed] = useStateRef(false);\n    const [________, setGameStarted, gameStarted] = useStateRef(false);\n    const [_sp, setPlayFlag, playFlag] = useStateRef(false);\n    const [_, setRecallFlag, recallFlag] = useStateRef(false);\n    const [_a, setAllowAudio, allowAudio] = useStateRef(false);\n    const [_s, setTimeToPlay, timeToPlay] = useStateRef(null);\n    const [__, setPlayedTiles, playedTiles] = useStateRef([]);\n    const [_b_, setBoardState, boardState] = useStateRef([]);\n    const [_r_, setRackState, rackState] = useStateRef([]);\n    const [__pw, setPlayedWords, playedWords] = useStateRef([]);\n    const [__f, setUsedTiles, usedTiles] = useStateRef([]);\n    const [___, setValidDrag, validDrag] = useStateRef(true);\n    const [____, setPlayers, players] = useStateRef([]);\n    const [_____, setPlayer, player] = useStateRef({});\n    const [______, setBag, bag] = useStateRef({ length: 0, pieces: {} });\n    const [_______, setNotifications, notifications] = useStateRef([]);\n\n    const sio = useContext(SocketIOContext);\n    const gameContext = {\n        bag, setBag,\n        player, setPlayer,\n        players, setPlayers,\n        playFlag, setPlayFlag,\n        gameEnded, setGameEnded,\n        usedTiles, setUsedTiles,\n        rackState, setRackState,\n        boardState, setBoardState,\n        allowAudio, setAllowAudio,\n        recallFlag, setRecallFlag,\n        timeToPlay, setTimeToPlay,\n        gameStarted, setGameStarted,\n        gameCreated, setGameCreated,\n        gameResumed, setGameResumed,\n        playedTiles, setPlayedTiles,\n        playedWords, setPlayedWords,\n    }\n\n\n    // Register listeners\n    useEffect(() => {\n        sio.on(\"resumeDone\", (data) => {\n            // Save bag\n            setBag(data.bag);\n            setGameResumed(true);\n            setGameStarted(true);\n\n\n            const updatedPlayers = [];\n            const playerToPlay = data.playerToPlay;\n            let playerToPlayMessage = \"\";\n\n            // Set turn for each player\n            for (const p of players.current) {\n                if (p.name === playerToPlay) {\n                    p['turn'] = true;\n                }\n                updatedPlayers.push(p);\n            }\n\n            // Update player's players\n            setPlayers(updatedPlayers);\n\n            // Say who gets to play first\n            if (playerToPlay === player.current.name) {\n                playerToPlayMessage = `You were to play before the game was paused`;\n                setPlayer({ ...player.current, turn: true })\n            } else {\n                playerToPlayMessage = `${playerToPlay} was to play before the play was paused`;\n            }\n\n            // Notify everyone\n            setNotifications([\n                {\n                    message: `${playerToPlayMessage}. The game has resumed.`,\n                    overwrite: false,\n                    type: \"info\",\n                    timeout: 5\n                }\n            ]);\n        });\n\n        sio.on(\"drawDone\", (data) => {\n            // Save bag\n            setBag(data.bag);\n            setGameStarted(true);\n\n            const updatedPlayers = [];\n            const playerToPlay = data.players[0];\n            let playerToPlayMessage, playOrderMessage = \"\";\n\n            // Set turn for each player\n            for (const p of players.current) {\n                if (p.name === playerToPlay) {\n                    p['turn'] = true;\n                }\n                updatedPlayers.push(p);\n            }\n\n            // Update player's players\n            setPlayers(updatedPlayers);\n\n            // Say who gets to play first\n            if (playerToPlay === player.current.name) {\n                playerToPlayMessage = `You get to play first`;\n                setPlayer({ ...player.current, turn: true })\n            } else {\n                playerToPlayMessage = `${playerToPlay} gets to play first`;\n            }\n\n            // Set turn order of players\n            data.players.forEach((p, index) => {\n                if (p === player.current.name) {\n                    p = `${p} (You)`;\n                }\n                if (index + 1 === data.players.length) {\n                    playOrderMessage += p;\n                } else {\n                    playOrderMessage += `${p}, then `;\n                }\n            });\n\n            // Notify everyone\n            setNotifications([\n                {\n                    message: `${playerToPlayMessage}. Also note that the turn order is, ${playOrderMessage}`,\n                    overwrite: false,\n                    type: \"info\",\n                    timeout: 5\n                }\n            ]);\n        });\n\n\n        sio.on(\"validPlay\", (data) => {\n\n            // Update the players' turns\n            updatedPlayerTurns(data.playerToPlay.name)\n\n            if (data.name === player.current.name) {\n                setPlayer({ ...player.current, score: data.updatedScore });\n            }\n\n            // Update state of all players\n            setPlayers(getUpdatedPlayers(data));\n\n            // Announce type of play\n            announcePlayResult(data)\n\n            // Cement used tiles\n            setUsedTiles([...new Set([...usedTiles.current, ...playedTiles.current])]);\n\n            // Update bag\n            setBag(data.bag);\n\n            // Give a bag length heads up\n            announceBagState(data.bag.length)\n\n            // Reset played tiles\n            setPlayedTiles([]);\n\n            // Game ends after six consecutive turn skips or empty bag and player's empty rack\n            if (data.turnSkips === 6 || (data.bagIsEmpty && data.rackIsEmpty)) setGameEnded(true);\n        });\n    }, []);\n\n\n    // Update player turns\n    const updatedPlayerTurns = (playerToPlay) => {\n        if (playerToPlay === player.current.name)\n            setPlayer({ ...player.current, turn: true })\n        else setPlayer({ ...player.current, turn: false });\n    }\n\n    // Update every players' turn on table and [poosibly] scores\n    const getUpdatedPlayers = (data) => {\n        let updatedPlayers = [];\n        for (const p of players.current) {\n            if (p.name === data.playerToPlay.name) p.turn = true;\n            else p.turn = false;\n\n            // Update all scores on scoreboard\n            if (p.name === data.name) p.score = data.updatedScore;\n            updatedPlayers.push(p);\n        }\n\n        return updatedPlayers;\n    }\n\n    // Give a heads up if bag is almost empty\n    const announceBagState = (bagLength) => {\n        if (bagLength <= 7) {\n            let emptyMessage;\n\n            if (bagLength === 0) {\n                emptyMessage = \"No pieces are left in the bag\";\n            } else if (bagLength === 1) {\n                emptyMessage = \"Only one piece is left in the bag\";\n            } else {\n                emptyMessage = `Only ${bagLength} pieces are left in the bag.`;\n            }\n\n            setTimeout(() => {\n                setNotifications([\n                    {\n                        message: `Heads up! ${emptyMessage}`,\n                        type: \"warning\",\n                    }\n                ]);\n            }, 7000);\n        }\n    }\n\n\n    // Announce type of play\n    const announcePlayResult = (data) => {\n        let message;\n        let turnPlayer = `It's ${data.playerToPlay.name === player.current.name ? \"your\" : `${data.playerToPlay.name}'s`}`;\n\n        // If turn is skipped, announce\n        if (data.isTurnSkipped) {\n            message = data.name === player.current.name\n                ? \"You skipped your turn.\"\n                : `Turn skipped by ${data.name}.`;\n            message += ` ${turnPlayer} turn to play`;\n        }\n\n        // If turn is swapped, announce\n        else if (data.isTurnSwapped) {\n            message = data.name === player.current.name\n                ? \"You swapped pieces for your turn.\"\n                : `${data.name} swapped pieces for turn.`;\n            message += ` ${turnPlayer} turn to play`;\n        }\n\n        // If a word was played, announce\n        else {\n            message = data.name === player.current.name\n                ? `You played '${data.word}' worth ${data.score} points.`\n                : `${data.name} played '${data.word}' worth ${data.score} points.`;\n            message += ` ${turnPlayer} turn to play`;\n        }\n\n        setNotifications([{ type: \"success\", message }]);\n    }\n\n\n    const gameSpace =\n        <div className=\"flex space-x-10\">\n            <GameBoard />\n            <div className=\"px-10\"></div>\n            <GamePanel />\n        </div>\n\n    return (\n        <div className=\"container mx-auto p-10 flex h-screen justify-center\">\n            <NotificationContext.Provider value={{ notifications, setNotifications }}>\n                <GameContext.Provider value={gameContext}>\n                    <ValidDragContext.Provider value={{ validDrag, setValidDrag }}>\n                        {gameCreated.current || gameResumed.current ? gameSpace : <LandingPage />}\n                        <WinnerModal />\n                    </ValidDragContext.Provider>\n                </GameContext.Provider>\n            </NotificationContext.Provider>\n        </div>\n    )\n};\n\nexport default Game;","import './App.css';\nimport Game from './containers/Game';\nimport { SocketIOContext } from './context';\n\nimport { socket } from './context';\n\nfunction App() {\n  return (\n    <SocketIOContext.Provider value={socket}>\n      <div className=\"App\">\n        <Game />\n      </div>\n    </SocketIOContext.Provider>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}